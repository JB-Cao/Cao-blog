<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='分享一些R进阶使用小技巧，包括R编程，debug，RMarkdown，写R包等等。'>
<title>R进阶使用技巧</title>

<link rel='canonical' href='https://jb-cao.github.io/Cao-blog/p/r-tips/'>

<link rel="stylesheet" href="/Cao-blog/scss/style.min.f0ecc11a39cd68bcc1eeb399f153637c1d516d2f399c93e65d25e7606d35ca1e.css"><meta property='og:title' content='R进阶使用技巧'>
<meta property='og:description' content='分享一些R进阶使用小技巧，包括R编程，debug，RMarkdown，写R包等等。'>
<meta property='og:url' content='https://jb-cao.github.io/Cao-blog/p/r-tips/'>
<meta property='og:site_name' content='Cao&#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='R' /><meta property='article:tag' content='编程' /><meta property='article:published_time' content='2024-06-16T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-06-16T00:00:00&#43;00:00'/><meta property='og:image' content='https://jb-cao.github.io/Cao-blog/p/r-tips/images/r-tips.png' />
<meta name="twitter:title" content="R进阶使用技巧">
<meta name="twitter:description" content="分享一些R进阶使用小技巧，包括R编程，debug，RMarkdown，写R包等等。"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://jb-cao.github.io/Cao-blog/p/r-tips/images/r-tips.png' />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">
<link rel="shortcut icon" href="favicon/android-chrome-512x512.png" />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/Cao-blog/">
                
                    
                    
                    
                        
                        <img src="/Cao-blog/img/guodong1_hu_72aa525a63157f1a.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🐛🐶</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/Cao-blog">Cao&#39;s blog</a></h1>
            <h2 class="site-description">work hard, live happily.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/142776729'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Asa12138'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://asa12138.github.io/'
                        target="_blank"
                        title="Homepage"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-world-pin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M20.972 11.291a9 9 0 1 0 -8.322 9.686" /><path d="M3.6 9h16.8" /><path d="M3.6 15h8.9" /><path d="M11.5 3a17 17 0 0 0 0 18" /><path d="M12.5 3a16.986 16.986 0 0 1 2.578 9.018" /><path d="M21.121 20.121a3 3 0 1 0 -4.242 0c.418 .419 1.125 1.045 2.121 1.879c1.051 -.89 1.759 -1.516 2.121 -1.879z" /><path d="M19 18v.01" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/Asa12138_'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/Cao-blog/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/mindmap/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-sitemap"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M15 15m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M6 15v-1a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v1" /><path d="M12 9l0 3" /></svg>
                
                <span>Mindmap</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://jb-cao.github.io/Cao-blog/" selected>English</option>
                        
                            <option value="https://jb-cao.github.io/Cao-blog/zh-cn/" >中文</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#use-r">Use R</a>
      <ol>
        <li><a href="#r语言简介">R语言简介</a></li>
        <li><a href="#r--rstudio">R &amp; Rstudio</a></li>
        <li><a href="#学习资料">学习资料</a></li>
        <li><a href="#基本使用">基本使用</a>
          <ol>
            <li><a href="#1-装好r--rstudio-">1. 装好R &amp; Rstudio ✅</a></li>
            <li><a href="#2-认识基本数据类型结构">2. 认识基本数据类型，结构</a></li>
            <li><a href="#3-装好需要的包">3. 装好需要的包</a></li>
            <li><a href="#4-正确数据图像读入和写出">4. 正确数据/图像读入和写出</a></li>
            <li><a href="#5-关闭r走人-">5. 关闭R走人 ✅</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#r-programming">R programming</a>
      <ol>
        <li><a href="#程序控制结构">程序控制结构</a>
          <ol>
            <li><a href="#分支结构">分支结构</a></li>
            <li><a href="#循环结构">循环结构</a></li>
            <li><a href="#管道">管道</a></li>
            <li><a href="#函数">函数</a></li>
          </ol>
        </li>
        <li><a href="#debug">Debug</a></li>
        <li><a href="#代码整理">代码整理</a></li>
      </ol>
    </li>
    <li><a href="#r-markdown-to-everything">R markdown (to everything)</a>
      <ol>
        <li><a href="#to-documents">To Documents</a></li>
        <li><a href="#to-presentation">To Presentation</a></li>
        <li><a href="#to-research-papers">To Research Papers</a></li>
        <li><a href="#to-website">To Website</a></li>
        <li><a href="#to-blog">To Blog</a></li>
        <li><a href="#to-book">To Book</a></li>
      </ol>
    </li>
    <li><a href="#r-packageshiny">R package/shiny</a>
      <ol>
        <li><a href="#写r包">写R包</a></li>
        <li><a href="#制作shiny-app">制作Shiny APP</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/Cao-blog/p/r-tips/">
                <img src="/Cao-blog/p/r-tips/images/r-tips_hu_143b381623c9f907.png"
                        srcset="/Cao-blog/p/r-tips/images/r-tips_hu_143b381623c9f907.png 800w, /Cao-blog/p/r-tips/images/r-tips_hu_f72502531f70fb97.png 1600w"
                        width="800" 
                        height="353" 
                        loading="lazy"
                        alt="Featured image of post R进阶使用技巧" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/Cao-blog/categories/r/" style="background-color: #bebada; color: #fff;">
                R
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/Cao-blog/p/r-tips/">R进阶使用技巧</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            分享一些R进阶使用小技巧，包括R编程，debug，RMarkdown，写R包等等。
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 16, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    5 minute read
                </time>
            </div>
        
        
        

           <div>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



              <time class="article-words">
                版权归Cao's blog所有，转载请注明出处
              </time>
           </div>
        
    </footer>
    
    
    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="introduction">Introduction</h2>
<p>分享一些R进阶使用的技巧，相当于是之前写的<a class="link" href="../r-learning" >R语言学习</a>的实践和总结了。</p>
<ul>
<li>
<p>Online slide: <a class="link" href="https://asa-blog.netlify.app/R_tips_for_advanced_use_byAsa/R_tips.html"  target="_blank" rel="noopener"
    >https://asa-blog.netlify.app/R_tips_for_advanced_use_byAsa/R_tips.html</a></p>
</li>
<li>
<p>下载slide和相关的各种test文件: <a class="link" href="https://asa-blog.netlify.app/R_tips_for_advanced_use_byAsa/R_tips_for_advanced_use_byAsa.zip"  target="_blank" rel="noopener"
    >https://asa-blog.netlify.app/R_tips_for_advanced_use_byAsa/R_tips_for_advanced_use_byAsa.zip</a></p>
</li>
<li>
<p>视频教程: <a class="link" href="https://www.bilibili.com/video/BV1eg4y1w7AL/"  target="_blank" rel="noopener"
    >https://www.bilibili.com/video/BV1eg4y1w7AL/</a></p>
</li>
<li>
<p>*才疏学浅，仅代表本人学习经验，R是一个宝库，此处只是冰山一角</p>
</li>
</ul>
<h2 id="use-r">Use R</h2>
<h3 id="r语言简介">R语言简介</h3>
<p>R语言是S语言的一个变种。S语言由Rick Becker等人在贝尔实验室开发（著名的C语言、Unix系统开发实验室）。</p>
<p>R是一个自由源代码软件，GPL授权，于1997年发布，实现了与S语言基本相同的功能和统计功能。 现在由R核心团队开发，但全世界的用户都可以贡献软件包。</p>
<p>R的网站: <a class="link" href="http://www.r-project.org/"  target="_blank" rel="noopener"
    >http://www.r-project.org/</a></p>
<p>特点：</p>
<ul>
<li>自由软件，免费、开放源代码，支持各个主要计算机系统；</li>
<li>具有完善的数据类型，代码简洁、可读；</li>
<li><strong>强调交互式数据分析，支持复杂算法描述，图形功能强</strong>；</li>
<li>统计科研工作者广泛使用R进行计算和发表算法。R有<strong>上万扩展包</strong>(截止2023年7月5日在R包网站CRAN上有19784个)。</li>
</ul>
<p>S语言作者，R语言专家J. M. Chambers指出R的.red[本质特征]：</p>
<ul>
<li>R中所有的存在都是<strong>对象</strong>（object）；</li>
<li>R中发生的动作都是<strong>函数调用</strong>（function call）。</li>
</ul>
<p>详细地说R有如下技术特点：</p>
<ul>
<li>函数编程（functional programming）。</li>
<li>支持对象类和类方法，面向对象的程序设计。</li>
<li>动态类型语言，解释执行，速度较慢。</li>
<li>数据框（data.frame）是基本数据类型，类似于数据库的表。</li>
<li>可以用作C和C++、FORTRAN语言编写的算法库的接口。</li>
<li>内部数值算法采用已广泛测试和采纳的算法实现，如排序、线性代数等。</li>
</ul>
<h3 id="r--rstudio">R &amp; Rstudio</h3>
<ul>
<li>R是一种统计学编程语言</li>
<li>Rstudio是R语言最好的IDE（Integrated development environment）</li>
</ul>
<img src="https://asa-blog.netlify.app//R_tips_for_advanced_use_byAsa/images/Rstudio.png" title=""/>
<p>2022年RStudio公司正式改名Posit，拥抱大数据科学生态：R、Python、Julia&hellip;</p>
<img src="https://asa-blog.netlify.app//R_tips_for_advanced_use_byAsa/images/Rstudio2.png" title=""/>
<p>RStudio使用方法概要PDF下载：<a class="link" href="https://www.math.pku.edu.cn/teachers/lidf/docs/Rbook/html/_Rbook/rstudio-ide.pdf"  target="_blank" rel="noopener"
    >rstudio-ide.pdf</a></p>
<p>Rstuido的魔法：按住Ctrl（Command）单击某个变量名或函数名，如果是data.frame就可以进入预览窗格，
如果是函数就可以进入函数内部看具体的代码。</p>
<p>其实是调用了<code>View()</code>函数，对于不是以上类型的对象我们可以手动调用。</p>
<h3 id="学习资料">学习资料</h3>
<ul>
<li>
<p>全面教程
小白上手首推北大李老师的课程讲义<a class="link" href="https://www.math.pku.edu.cn/teachers/lidf/docs/Rbook/html/_Rbook/index.html"  target="_blank" rel="noopener"
    >《R语言教程》</a>，中文讲义，简单易读，甚至整本书就是用Rbookdown编写的，电子书也比较好复制代码进行学习。</p>
<p><a class="link" href="https://www.zhihu.com/search?q=R%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A217799209%7D"  target="_blank" rel="noopener"
    >《R语言实战》</a>，也有中文版，介绍地更加全面且有不少进阶知识，值得一看！</p>
<p>然后是著名的英文书和参考手册：</p>
<ul>
<li><a class="link" href="cran.r-project.org/doc/manuals/R-intro.pdf" >《An Introduction to R》</a></li>
<li><a class="link" href="https://rc2e.com/"  target="_blank" rel="noopener"
    >《R Cookbook》</a></li>
</ul>
</li>
<li>
<p>数据处理</p>
<p>tidyverse全家桶，其中包含ggplot2，tibble，dplyr，readr，stringr等常用的全面的数据处理包，能够很好的满足我们下游数据处理需求：</p>
<ul>
<li>读取数据</li>
<li>清洗数据</li>
<li>转换数据</li>
<li>合并数据</li>
<li>筛选数据</li>
<li>可视化</li>
</ul>
<p>官方教程：<a class="link" href="https://bookdown.org/roy_schumacher/r4ds/"  target="_blank" rel="noopener"
    >《R for Data Science》</a>，非常建议熟读并使用</p>
</li>
<li>
<p>可视化</p>
<p>ggplot官方教程：<a class="link" href="https://ggplot2-book.org/"  target="_blank" rel="noopener"
    >《ggplot2: Elegant Graphics for Data Analysis》</a></p>
<p>为可视化而建的网站：<a class="link" href="https://www.data-to-viz.com"  target="_blank" rel="noopener"
    >From data to Viz | Find the graphic you need</a></p>
</li>
</ul>
<h3 id="基本使用">基本使用</h3>
<p>很多人使用 R，只为用其中的某个包的某个功能，只需学会以下几步即可：</p>
<h4 id="1-装好r--rstudio-">1. 装好R &amp; Rstudio ✅</h4>
<h4 id="2-认识基本数据类型结构">2. 认识基本数据类型，结构</h4>
<ul>
<li>数值型常量 <code>1,1e2,5L,Inf,-Inf</code>;</li>
<li>字符型常量 <code>&quot;str&quot;,'str'</code>;</li>
<li>逻辑型常量 <code>TRUE,FALSE,T,F</code>;</li>
<li>缺失值 <code>NaN,NA</code>, 空值 <code>NULL</code>;</li>
<li>复数常量 <code>2.2 + 3.5i</code>;</li>
<li>变量，区分大小写的字母、数字、下划线和句点组成变量名，支持但不建议中文;</li>
<li>向量(vector)：用<code>c()</code>函数把多个元素或向量组合成一个<strong>向量</strong>。如果元素基本类型不同，将统一转换成最复杂的一个，复杂程度从简单到复杂依次为： logical&lt;integer&lt;double&lt;character。此外还可以有Date和factor类型的元素</li>
<li>列表(list)：包装保存不同类型的数据。单个列表元素必须用两重方括号格式访问,单重方括号结果还是列表而不是列表元素。普通有names属性的列表可以用<code>$</code>访问元素，S4对象可以用<code>@</code>访问元素。</li>
<li>矩阵，数组(matrix, array)：矩阵用matrix函数定义，实际存储成一个向量，根据保存的行数和列数对应到矩阵的元素， 存储次序为按列存储。</li>
<li>数据框(data.frame)：数据框类似于一个矩阵，有多个横行、多个纵列，各列允许有不同类型：数值型、因子、字符、日期时间，但同一列的数据类型相同。取子集应注意<code>drop</code> 。</li>
<li>改进数据框(tibble)：tibble类型是一种改进的数据框，tidyverse全家桶推荐使用，确实有不少好处：
不会随意改变我们的数据名称，类型。打印优美。</li>
</ul>
<h4 id="3-装好需要的包">3. 装好需要的包</h4>
<p>包是R函数、数据、预编译代码以一种定义完善的格式组成的集合。</p>
<ul>
<li>找到包，主要平台：
<ul>
<li><a class="link" href="https://cran.r-project.org/"  target="_blank" rel="noopener"
    >CRAN</a> 官方存储库，多个镜像</li>
<li><a class="link" href="https://www.bioconductor.org/"  target="_blank" rel="noopener"
    >BioConductor</a> 用于生物信息学的开源软件专题库</li>
<li><a class="link" href="https://github.com/"  target="_blank" rel="noopener"
    >Github</a> 开发版本，无限惊喜，但也可能缺少维护</li>
<li>Bitbucket、SVN&hellip;</li>
</ul>
</li>
<li>装在哪，本机位置：</li>
</ul>
<p>计算机上存储包的目录称为库（library）。
函数<code>.libPaths()</code>能够显示库所在的位置，函数<code>library()</code>可以显示库中有哪些包。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">.libPaths</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个地址很重要，有时候会有多个（如Windows分区），我们要搞清楚装在哪里。</p>
<ul>
<li>怎么装，<a class="link" href="https://cran.r-project.org/web/packages/pcutils/index.html"  target="_blank" rel="noopener"
    >例子</a>：大部分情况下CRAN用 <code>install.packages(&quot;pkg&quot;)</code>，BioConductor用<code>BiocManager::install(&quot;pkg&quot;)</code>，Github用<code>devtools::install_github(&quot;repos&quot;)</code>即可。
但有时候会有依赖包相关的报错，我们可以手动下载特定版本包文件后安装。</li>
</ul>
<img src="https://asa-blog.netlify.app//R_tips_for_advanced_use_byAsa/images/pkg_state.png" title=""/>
<ul>
<li>source， 源码，一堆R脚本和文本文件，我们直接在github上看的就是这个。</li>
<li>bundle， 捆绑态，其实就是打包过的source，一般.tar.gz结尾。</li>
<li>binary， 二进制版本，架构不一样，.zip(Windows)或.tgz(macOS)结尾。</li>
</ul>
<p>所谓安装包就是把source变成binary在放在我们的<code>.libPaths()</code>文件夹下。</p>
<p>还有问题，谷歌大法，或github问包作者。
带C++的R包出问题会麻烦一些，需要考察自己本机的C语言编译器。</p>
<ul>
<li>怎么用包</li>
</ul>
<p>首先可以用<code>library(pkg)</code>或<code>require(pkg)</code>将包导入内存，这样便可以调用其中的函数。
<code>search()</code>函数可以查看我们已经library的包。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">pcutils</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">search</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="s">&#34;pcutils&#34;</span><span class="p">))</span> <span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;pcutils&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用<code>pkg::</code>加上tab键可以列出某个包里所有导出的函数，多用<code>help(pkg::func)</code>或<code>?pkg::func</code>查看某个函数的用法。</p>
<p>如果不想用某个包了，可以用<code>detach</code>从当前环境移除（不是删除包）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">detach</span><span class="p">(</span><span class="s">&#34;package:pcutils&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4-正确数据图像读入和写出">4. 正确数据/图像读入和写出</h4>
<p>各种表格读取：read.table(), read.csv(), read.delim()</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;test.txt&#34;</span><span class="p">)</span> <span class="c1">#无法读取</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>当我们的表格含有 <code>&quot;, ', #</code> 或者列名中含有任何非变量名字符时都要小心</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;test.txt&#34;</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s">&#34;\t&#34;</span><span class="p">,</span><span class="n">comment.char</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">,</span><span class="n">quote</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">,</span><span class="n">check.names</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>建议在readr包的支持下用read_csv(), read_table2(), read_delim()等函数读入。</p>
<p>保存为tibble类型，快得多，也不自动将字符型列转换成因子，不自动修改变量名为合法变量名。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">readr</span><span class="o">::</span><span class="nf">read_delim</span><span class="p">(</span><span class="s">&#34;test.txt&#34;</span><span class="p">,</span><span class="n">delim</span> <span class="o">=</span> <span class="s">&#34;\t&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>excel用<code>readxl</code>包，剪切板可用<code>datapasta</code>包或<code>clipr::read_clip()</code>。表格写出用<code>write_*()</code>，与读入一致。</p>
<p>任意文件访问，跟python很像，使用<code>file()</code>打开文件，<code>close()</code>关闭。</p>
<ul>
<li>r—文本型只读;
w—文本型只写;
a—文本型末尾添加;</li>
<li>rb—二进制只读;
wb—二进制只写;
ab—二进制末尾添加;</li>
<li>r+或r+b—读写;
w+或w+b—读写，清空文件;
a+或a+b—读和末尾添加。</li>
</ul>
<p>或者可以用<code>cat()</code>直接输出任意文本到文件。</p>
<p><code>clipr::write_clip()</code>可以把R数据框或向量写入剪切板，可以直接粘贴他处。</p>
<p>图片保存：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">pdf</span><span class="p">(</span><span class="s">&#34;new.pdf&#34;</span><span class="p">)</span> <span class="c1">#png(),jpg(),tiff(),bmp()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#画一些图</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span> <span class="c1">#要记得关闭设备</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">ggplot2</span><span class="o">::</span><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;new.pdf&#34;</span><span class="p">,</span><span class="n">plot</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span><span class="n">device</span> <span class="o">=</span> <span class="s">&#34;pdf&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="c1">#p是一个ggplot对象，device可选各种文件格式</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>R变量储存：</p>
<p>R的<code>save()</code>命令可以将一个或者多个R变量保存到文件(<code>.rda</code>或<code>.RData</code>)中，保存结果是经过压缩的，在不同的R运行环境中兼容。
使用<code>load()</code>可以恢复保存的变量。</p>
<p>强烈建议传递数据时用这种文件，避免了数据写入和读取时引起的差异。</p>
<p>使用<code>save.image()</code>可以把整个环境的所有变量保存，方便结果复现。</p>
<p>保存单变量时推荐使用<code>saveRDS()</code>，用<code>readRDS()</code>载入并返回变量，这样可以将某个变量赋值给某个拟定的变量名，避免某个变量值变了我们还不知道， 如</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">saveRDS</span><span class="p">(</span><span class="n">old</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#34;tmp.RDS&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new</span><span class="o">=</span><span class="nf">readRDS</span><span class="p">(</span><span class="s">&#34;tmp.RDS&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="5-关闭r走人-">5. 关闭R走人 ✅</h4>
<h2 id="r-programming">R programming</h2>
<h3 id="程序控制结构">程序控制结构</h3>
<h4 id="分支结构">分支结构</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">(</span><span class="s">&#34;x &gt; 0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">(</span><span class="s">&#34;x &lt;= 0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#或者用switch函数</span>
</span></span><span class="line"><span class="cl"><span class="kr">switch</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="m">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="bp">T</span> <span class="o">=</span> <span class="p">{</span><span class="nf">print</span><span class="p">(</span><span class="s">&#34;x &gt; 0&#34;</span><span class="p">)},</span>
</span></span><span class="line"><span class="cl">    <span class="bp">F</span> <span class="o">=</span> <span class="p">{</span><span class="nf">print</span><span class="p">(</span><span class="s">&#34;x &lt;= 0&#34;</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#或者用ifelse函数，向量式</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ifelse</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="循环结构">循环结构</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">#或者用while函数</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="kr">while</span> <span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="m">4</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="m">+1</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">#或者用repeat函数</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="kr">repeat</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="m">+1</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="m">3</span><span class="p">)</span><span class="kr">break</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意用到的判断条件必须是逻辑标量值，不能为NA或零长度。
这是R编程时比较容易出错的地方。</p>
<p>循环结构进阶，<code>apply()</code>家族</p>
<p>上述显式循环是R运行速度较慢的部分，有循环的程序也比较冗长，建议使用<code>apply, sapply, lapply, vapply, tapply</code>等函数替代。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">func</span><span class="o">=</span><span class="kr">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>另外，建议循环过程不要制作副本：</p>
<p>类似于<code>x &lt;- c(x, y)</code>这样的累积结果每次运行都会制作一个x的副本， 在x存储量较大或者重复修改次数很多时会减慢程序。</p>
<p>而是应该在循环前设置好用来保存结果的数据结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="nf">numeric</span><span class="p">(</span><span class="m">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x[[i]]</span><span class="o">=</span><span class="p">{</span><span class="n">i循环100次产生的结果</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="管道">管道</h4>
<p>原生管道，R从4.1.0版本开始提供了一个<code>|&gt;</code>运算符实现管道，如计算 $e^{\sqrt{2}}$：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="m">2</span> <span class="o">|&gt;</span> <span class="nf">sqrt</span><span class="p">()</span> <span class="o">|&gt;</span> <span class="nf">exp</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>但是我还是更喜欢用<code>magrittr</code>提供的<code>%&gt;%</code>，支持更复杂的应用，比如用<code>.</code>代表产生的中间变量放到合适的参数位置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="s">&#34;hhh&#34;</span><span class="o">%&gt;%</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;prefix_&#34;</span><span class="p">,</span><span class="n">.)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>还有<code>%&lt;&gt;%</code>等方便的变体:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="s">&#34;hhh&#34;</span><span class="p">;</span> <span class="n">a</span><span class="o">%&lt;&gt;%</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;prefix_&#34;</span><span class="p">,</span><span class="n">.)</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="函数">函数</h4>
<p>使用自定义函数， 优点是代码复用、模块化设计。</p>
<blockquote>
<p>函数名 &lt;- function(形式参数表) 函数体</p></blockquote>
<p><strong>特殊形参</strong>：<code>...</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">my_mean</span><span class="o">=</span><span class="kr">function</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span><span class="nf">sum</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span><span class="o">/</span><span class="nf">length</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="kc">...</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">my_mean</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>无名函数</strong>: 不定义函数名也可以调用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="nf">\</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>变量作用域</strong>：全局变量 vs 局部变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="m">100</span>
</span></span><span class="line"><span class="cl"><span class="n">func</span><span class="o">=</span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="m">+1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">func</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>R中所有的存在都是<strong>对象</strong>（object）
对象其实就是一种封装的概念，它把事物封装成一个类(class)，然后提供类的方法(method)，而具体的过程人们看不到。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>R中发生的动作都是<strong>函数调用</strong>（function call）???</li>
</ul>
<p>函数调用有四种方式：</p>
<p>1 前缀形式。
这也是一般的格式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">mean</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2 中缀形式。二元运算符实际上都是函数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="m">1+1</span>
</span></span><span class="line"><span class="cl"><span class="nf">`+`</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">`%love%`</span><span class="o">=</span><span class="kr">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="nf">paste0</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s">&#34; loves &#34;</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="s">&#34;Romeo&#34;</span><span class="o">%love%</span><span class="s">&#34;Juliet&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>3 替换形式。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">`names&lt;-`</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>4 特殊形式。x[1], x[[1]]这些取子集或元素等</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="n">x[1]</span>
</span></span><span class="line"><span class="cl"><span class="nf">`[`</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>确实，R中发生的动作都是<strong>函数调用</strong>（function call），知晓函数调用的形式，可以让我们在用某些包的函数时明确问题来源，查找源码等。</p>
<h3 id="debug">Debug</h3>
<p>某个函数突然失灵了</p>
<ol>
<li>工作环境变化</li>
</ol>
<p>环境是R语言比较困难的概念，一般不需要深入了解也能用。</p>
<p>但我们要知道，大多数时候我们处于Global Environment，我们敲出来的每一个变量名(函数名)都是优先在全局环境找，找不到的话就<code>search()</code>里面按顺序去每个环境找。
所以要注意环境优先级以及变量名冲突，极端情况如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="m">1+1</span> <span class="c1">#正常当然等于2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#定义了`+`,或者新导入的包包含一个`+`的函数名，覆盖了base的加法</span>
</span></span><span class="line"><span class="cl"><span class="n">`+`</span><span class="o">=</span><span class="n">`-`</span>
</span></span><span class="line"><span class="cl"><span class="m">1+1</span> <span class="c1">#结果会变成0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>常使用<code>pkg::func</code>的形式调用函数是个好习惯，可以防止不同包的同名函数冲突。</p>
<ol start="2">
<li>断点，<code>traceback()</code>，<code>debug()</code>， <code>browser()</code></li>
</ol>
<p>反向追踪(traceback)将错误定位到某一函数调用。</p>
<p>可以用<code>debug(func)</code>命令对函数func开启跟踪运行。</p>
<p>用<code>undebug(func)</code>取消对func的这种操作。</p>
<ol start="3">
<li>我要debug的函数在哪？</li>
</ol>
<p>一般来说我们可以找到报错的代码行以及具体的函数，便可以使用<code>debug()</code>。</p>
<p>但有时候会发现一些函数无法被正确定位，具体代码也只能看到<code>UseMethod()</code>：其实是我们碰到了<strong>泛型函数</strong>。下面同样一个<code>summary</code>函数，为啥对women和fit做出了完全不同的处理？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">women</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">weight</span> <span class="o">~</span> <span class="n">height</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">women</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">women</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">weight</span> <span class="o">~</span> <span class="n">height</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">women</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">women</span><span class="p">);</span> <span class="nf">class</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>原来他们是不同的类（class），泛型函数会更具对象的类选择运行什么样的代码（即见人说人话，见鬼说鬼话）：
调用<code>func.class()</code>函数，上述就是分别调用了<code>summary.data.frame()</code>，<code>summary.lm()</code>。<code>print</code>和<code>plot</code>也是非常常见的泛型函数。</p>
<p>或者我们可能发现某些报错函数not found（但我们又确定有这样一个函数）：
其实是我们碰到了<strong>非导出函数</strong>（R包开发者不想用户看到所有的函数，只把有用的导出）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">reshape2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#melt是泛型函数，那应该调用melt.data.frame</span>
</span></span><span class="line"><span class="cl"><span class="nf">melt.data.frame</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="n">id.vars</span> <span class="o">=</span> <span class="s">&#34;cyl&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Error in melt.data.frame(mtcars, id.vars = &#34;cyl&#34;) : </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  could not find function &#34;melt.data.frame&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>找到这些函数的方法也很简单（毕竟R包需要都开源）：<code>pkg:::func</code>即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">reshape2</span><span class="o">:::</span><span class="nf">melt.data.frame</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="n">id.vars</span> <span class="o">=</span> <span class="s">&#34;cyl&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有时候我们通过debug可以发现一些有用的内部函数（比如从那种一步/很久完成XX分析的函数中找到我们需要的功能），
这样我们便可以使用<code>pkg:::func</code>做想做的部分。</p>
<h3 id="代码整理">代码整理</h3>
<p>我们在做数据分析时会产生大量代码，做好整理非常重要。</p>
<ul>
<li>
<p>最开始，每一个独立的R脚本进行分析 （代码冗余度太高，后期很难快速看懂）</p>
</li>
<li>
<p>学会编写函数，复制函数到不同的R脚本使用（n个地方的函数需要修改n次）</p>
</li>
<li>
<p>将常用的函数放在一个R脚本下，要用的时候<code>source()</code>整个脚本（全局环境中出现大量函数名，可能还会引起冲突）</p>
</li>
<li>
<p>将常用函数整理成R包，写好注释和帮助文档，方便调用和分享 （嘎嘎香)</p>
</li>
</ul>
<p>接下来的3,4部分非必需，但我觉得学习后便会有惊喜：</p>
<h2 id="r-markdown-to-everything">R markdown (to everything)</h2>
<p>R Markdown是一种文本格式，用于创建具有代码、文本、图形和输出结果的可重复性报告。
是“文学式编程”(literate programming, (Knuth 1984))思想的实践。</p>
<p>它是在R语言环境中开发的，也可以与其他编程语言（如Python，shell）结合使用。</p>
<p>优点：</p>
<ul>
<li>可重复性：代码和结果都是可重复的，有助于确保研究结果的可靠性和透明度。</li>
<li>效率：使用R Markdown在单个文件中组织和记录所有内容，节省时间和精力。</li>
<li>灵活性：R Markdown支持多种格式和输出选项，根据需要自定义样式布局。</li>
</ul>
<p>总之，比word好用，比Latex好学😂</p>
<p>Yihui Xie大佬的官方文档：<a class="link" href="https://bookdown.org/yihui/rmarkdown/"  target="_blank" rel="noopener"
    >R Markdown: The Definitive Guide (bookdown.org)</a></p>
<p>以及参考书：<a class="link" href="https://bookdown.org/yihui/rmarkdown-cookbook/"  target="_blank" rel="noopener"
    >R Markdown Cookbook (bookdown.org)</a></p>
<h3 id="to-documents">To Documents</h3>
<p>Rmd文档头部是YAML元数据，可指定各种输出参数</p>
<ol>
<li>
<p><a class="link" href="to_document/test.html" >HTML</a></p>
</li>
<li>
<p><a class="link" href="to_document/test.pdf" >PDF</a></p>
</li>
<li>
<p>Word</p>
</li>
</ol>
<p>优点：</p>
<ol>
<li>
<p>公式，化学分子式非常好写</p>
</li>
<li>
<p>文献插入也不错（配合Zotero）</p>
</li>
<li>
<p>图表自动编号和引用、链接（我觉得比word好用点）</p>
</li>
<li>
<p>支持交互式图形（HTML）</p>
</li>
</ol>
<h3 id="to-presentation">To Presentation</h3>
<p>R Markdown支持生成各种幻灯片文件（此幻灯片也是由Rmd生成的😂）</p>
<ol>
<li>
<p>PowerPoint</p>
<p>常用，易分享</p>
</li>
<li>
<p>ioslide/Slidy</p>
<p>网页格式的幻灯片，支持交互 (拜托，PPT可交互真的很酷)</p>
</li>
<li>
<p>Beamer</p>
<p>PDF幻灯片，模版众多，大学课堂热衷使用</p>
</li>
</ol>
<h3 id="to-research-papers">To Research Papers</h3>
<p><code>rticle</code>包，包含一套自定义 R Markdown 格式和模板，用于创作期刊文章和会议提交。</p>
<p>例子：</p>
<ul>
<li>
<p><a class="link" href="to_article/Test/Test.pdf" >Frontiers</a></p>
</li>
<li>
<p><a class="link" href="to_article/Bioinfo/Bioinfo.pdf" >Bioinformatics</a></p>
</li>
</ul>
<h3 id="to-website">To Website</h3>
<p>Rmarkdown可以帮助我们搭建简易网站：</p>
<ul>
<li>
<p>index.Rmd是主页内容， 可以在此处人工加入其它页面链接。</p>
</li>
<li>
<p>_site.yml是一个YAML文件， 其中包含站点的设定和输出设定。</p>
</li>
</ul>
<p><a class="link" href="to_website/_site/index.html" >例子</a>：</p>
<p>File -&gt; New Project -&gt; New directory -&gt; Simple R Markdown Website -&gt;</p>
<p>Create Project (click Open in new session) -&gt; Build -&gt; Build Website</p>
<h3 id="to-blog">To Blog</h3>
<p>R扩展包<a class="link" href="https://github.com/rstudio/blogdown"  target="_blank" rel="noopener"
    >blogdown</a>可以与Hugo软件配合制作简单的静态博客网站。</p>
<p>网站的所有文件都在一个目录中，只要上传到任意的网站服务器就可以发布，没有任何限制。</p>
<p>我的博客：<a class="link" href="https://asa-blog.netlify.app/"  target="_blank" rel="noopener"
    >Asa&rsquo;s blog</a></p>
<p>参考书：<a class="link" href="https://bookdown.org/yihui/blogdown/"  target="_blank" rel="noopener"
    >blogdown: Creating Websites with R Markdown (bookdown.org)</a></p>
<h3 id="to-book">To Book</h3>
<p>R的<a class="link" href="https://github.com/rstudio/bookdown"  target="_blank" rel="noopener"
    >bookdown</a>扩展包</p>
<p>在bookdown的管理下：一本书的内容可以分解成多个Rmd文件， 其中可以有可执行的R代码， R代码生成的文字结果、表格、图形可以自动插入到生成的内容中， 表格和图形可以是浮动排版的。 输出格式主要支持gitbook格式的网页图书。</p>
<p>我也稍微尝试写了一下：<a class="link" href="../../R/MetaNet_tutorial/_book/index.html" >MetaNet Tutorial</a></p>
<p>参考书：<a class="link" href="https://bookdown.org/yihui/bookdown/"  target="_blank" rel="noopener"
    >bookdown: Authoring Books and Technical Documents with R Markdown</a></p>
<h2 id="r-packageshiny">R package/shiny</h2>
<h3 id="写r包">写R包</h3>
<p>包是可重现 R 代码的基本单元，包括可重用的 R 函数、描述如何使用它们的文档和示例数据。
一个包将代码、数据、文档和测试捆绑在一起，并且很容易与他人共享。</p>
<p>简单例子（需要下载<code>roxygen2</code>包）：</p>
<p>File -&gt; New Project -&gt; New directory -&gt; R package -&gt;</p>
<p>Create Project (click Open in new session)-&gt; Package name -&gt; Build -&gt; Install</p>
<img src="https://asa-blog.netlify.app//R_tips_for_advanced_use_byAsa/images/rfile.png" title=""/>
<p>最简单的包只需要这些目录和文件即可，</p>
<ul>
<li><a class="link" href="" >R</a>目录下放在我们编写的R函数脚本</li>
<li><a class="link" href="https://r-pkgs.org/man.html"  target="_blank" rel="noopener"
    >man</a>目录放着所有函数的帮助文档（<code>roxygenise()</code>函数生成，不要自己写）</li>
<li><a class="link" href="https://r-pkgs.org/description.html"  target="_blank" rel="noopener"
    >DECRIPTION</a>定义了包的各种元数据，包名/版本/依赖包等等，非常重要</li>
<li><a class="link" href="https://r-pkgs.org/description.html"  target="_blank" rel="noopener"
    >NAMESPACE</a>控制函数的可视性（<code>roxygenise()</code>函数生成，不要修改！）</li>
</ul>
<p>参考书：<a class="link" href="https://r-pkgs.org/"  target="_blank" rel="noopener"
    >R Packages (2e) (r-pkgs.org)</a></p>
<p>如果真的有意开发R包，建议走<code>devtools</code>的流程，要比前面的简单例子好用。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">devtools</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#创建R包</span>
</span></span><span class="line"><span class="cl"><span class="nf">create_package</span><span class="p">(</span><span class="s">&#34;testpkg&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#配置git用于版本控制</span>
</span></span><span class="line"><span class="cl"><span class="nf">use_git</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#创建一个R脚本，开始写函数</span>
</span></span><span class="line"><span class="cl"><span class="nf">use_r</span><span class="p">(</span><span class="s">&#34;first&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#生成man文件和NAMESPACE</span>
</span></span><span class="line"><span class="cl"><span class="nf">document</span><span class="p">(</span><span class="s">&#34;./&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#使所有函数可用（没有install但R包已在内存）</span>
</span></span><span class="line"><span class="cl"><span class="nf">load_all</span><span class="p">(</span><span class="s">&#34;./&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#检查R包语法，建议每次重要修改后运行一次，解决完所有的Error，Warning，Note再进一步修改，不要积累较多错误</span>
</span></span><span class="line"><span class="cl"><span class="nf">check</span><span class="p">(</span><span class="s">&#34;./&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#打包为bundle包，.tar.gz</span>
</span></span><span class="line"><span class="cl"><span class="nf">build</span><span class="p">(</span><span class="s">&#34;./&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#install我们写好的R包</span>
</span></span><span class="line"><span class="cl"><span class="nf">install</span><span class="p">(</span><span class="s">&#34;./&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#定义一些测试例子</span>
</span></span><span class="line"><span class="cl"><span class="nf">use_testthat</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>循环后面几步：function -&gt; document -&gt; load_all -&gt; check -&gt;install，直到功能完善，check无误。</p>
<ul>
<li>函数应该功能明确，不能使用<code>library</code>，而应该用pkg::func调用，并且这里的pkg一定要在DESCRIPTION中声明。</li>
<li>函数不应该产生不良副作用，比如修改用户环境变量，谨慎使用<code>option</code>, <code>par</code>, <code>setwd</code>等函数。</li>
<li>函数的头文件很重要，包含了帮助文档以及决定函数性质的参数：</li>
<li>使用Shift+option+command+R可以帮助生成头文件</li>
</ul>
<p>发布包:</p>
<ul>
<li>
<p><a class="link" href="https://xmpalantir.wu.ac.at/cransubmit/"  target="_blank" rel="noopener"
    >CRAN submission</a> 请仔细阅读<a class="link" href="https://cran.r-project.org/web/packages/policies.html"  target="_blank" rel="noopener"
    >CRAN Repository Policy</a>，然后必须让代码通过<code>R CMD check</code>再提交，不然会直接拒收。我们提交的包是bundle包，.tar.gz格式。过了机检后就会有“审包人”联系（一般是志愿者，我们应当态度好些），
再积极沟通修改代码就好，最后通过审核一天就能在CRAN上看到了。</p>
</li>
<li>
<p><a class="link" href="https://www.bioconductor.org/"  target="_blank" rel="noopener"
    >BioConductor submission</a> 用于生物信息学的开源软件专题库，上传前仔细阅读<a class="link" href="https://contributions.bioconductor.org/submission-overview.html"  target="_blank" rel="noopener"
    >Guidelines</a>，
明确包的主题要跟生物有相关性（ Software, Experiment Data, Annotation and Workflow.），发布包的流程是<a class="link" href="https://github.com/Bioconductor/Contributions/issues"  target="_blank" rel="noopener"
    >Github issues</a>，
审核过程全公开透明，你现在就能点进去看有哪些包正在提交。</p>
</li>
<li>
<p><a class="link" href="https://github.com/"  target="_blank" rel="noopener"
    >Github</a> 这里就最自由了，你可以随意上传在自己的仓库，也可以邀请别人直接从github安装。</p>
</li>
</ul>
<h3 id="制作shiny-app">制作Shiny APP</h3>
<p>Shiny 是一个 R 包，可轻松地直接从 R 构建交互式 Web 应用程序。</p>
<p>可以在网页上托管独立应用程序或将它们嵌入 R Markdown 文档。还可以使用 CSS 主题、html 小部件和 JavaScript 操作扩展Shiny 应用程序。</p>
<p><a class="link" href="test_shiny/app.R" >例子</a>：</p>
<p>File -&gt; New Project -&gt; New directory -&gt; Shiny Application -&gt;</p>
<p>Create Project (click Open in new session) -&gt; Run App</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">shiny</span><span class="o">::</span><span class="nf">runApp</span><span class="p">(</span><span class="s">&#34;test_shiny/app.R&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>官方教程：<a class="link" href="https://shiny.rstudio.com/tutorial/"  target="_blank" rel="noopener"
    >Shiny Learning Resources</a></p>
<p>参考书：<a class="link" href="https://mastering-shiny.org/"  target="_blank" rel="noopener"
    >Mastering Shiny</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/Cao-blog/tags/r/">R</a>
        
            <a href="/Cao-blog/tags/%E7%BC%96%E7%A8%8B/">编程</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/Cao-blog/p/rshiny/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/rshiny/Rshiny.234e7f76ed8359b45b8025e13f656ba5_hu_e1321e751a387203.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post R-shiny应用开发（基础）"
                        data-key="rshiny" 
                        data-hash="md5-I05/du2DWbRbgCXhP2VrpQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">R-shiny应用开发（基础）</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/r-learning/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/r-learning/images/data2viz.651ec7891090db14ef0203dcbb62af54_hu_10ca77aac3e84ea3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post R语言学习"
                        data-key="r-learning" 
                        data-hash="md5-ZR7HiRCQ2xTvAgPcu2KvVA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">R语言学习</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/Cao-blog/p/bgckit-bgc/">
        
        

        <div class="article-details">
            <h2 class="article-title">BGCkit：组学数据BGC分析流程</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/metanet-8/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/metanet-8/images/nc.80f498412d2ea6135a9712c93dbb8eba_hu_86d7f3e82c9046db.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post MetaNet：多组学网络分析工具｜8.网络稳定性分析"
                        data-key="metanet-8" 
                        data-hash="md5-gPSYQS0uphNalxLJPbuOug==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MetaNet：多组学网络分析工具｜8.网络稳定性分析</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/metanet-7/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/metanet-7/index.en_files/figure-html/unnamed-chunk-5-1.347acced76b5c6eb13665a5b490dbdd9_hu_7eb69229f62ded98.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post MetaNet：多组学网络分析工具｜7.网络模块分析"
                        data-key="metanet-7" 
                        data-hash="md5-NHrM7Xa1xusTZlpbSQ292Q==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MetaNet：多组学网络分析工具｜7.网络模块分析</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="Asa12138/pc_blog2"
        issue-term="pathname"
        
        label="none"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025-6 - 
        
        2025 Cao&#39;s blog
    </section>
    
    <section class="powerby">
        
            Email: 17837411716@163.cn <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/Cao-blog/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='å®åŸºå› ç»„ï¼ˆMetagenomeï¼‰æ˜¯æŒ‡å¯¹ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ‰€æœ‰å¾®ç”Ÿç‰©è¿›è¡ŒDNAåˆ†æçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§ã€åŠŸèƒ½å’Œäº’ä½œå…³ç³»ã€‚è¿™é‡Œä»‹ç»å¸¸ç”¨çš„ä¸Šæ¸¸åˆ†ææµç¨‹ã€‚'>
<title>å®åŸºå› ç»„åˆ†ææµç¨‹ï¼ˆMetagenomic workflowï¼‰202408ï½œæŒç»­æ›´æ–°</title>

<link rel='canonical' href='https://jb-cao.github.io/Cao-blog/p/metagenomic-workflow/'>

<link rel="stylesheet" href="/Cao-blog/scss/style.min.f0ecc11a39cd68bcc1eeb399f153637c1d516d2f399c93e65d25e7606d35ca1e.css"><meta property='og:title' content='å®åŸºå› ç»„åˆ†ææµç¨‹ï¼ˆMetagenomic workflowï¼‰202408ï½œæŒç»­æ›´æ–°'>
<meta property='og:description' content='å®åŸºå› ç»„ï¼ˆMetagenomeï¼‰æ˜¯æŒ‡å¯¹ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ‰€æœ‰å¾®ç”Ÿç‰©è¿›è¡ŒDNAåˆ†æçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§ã€åŠŸèƒ½å’Œäº’ä½œå…³ç³»ã€‚è¿™é‡Œä»‹ç»å¸¸ç”¨çš„ä¸Šæ¸¸åˆ†ææµç¨‹ã€‚'>
<meta property='og:url' content='https://jb-cao.github.io/Cao-blog/p/metagenomic-workflow/'>
<meta property='og:site_name' content='Cao&#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='microbiome' /><meta property='article:published_time' content='2024-05-28T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-05-28T00:00:00&#43;00:00'/><meta property='og:image' content='https://jb-cao.github.io/Cao-blog/p/metagenomic-workflow/images/workflow.png' />
<meta name="twitter:title" content="å®åŸºå› ç»„åˆ†ææµç¨‹ï¼ˆMetagenomic workflowï¼‰202408ï½œæŒç»­æ›´æ–°">
<meta name="twitter:description" content="å®åŸºå› ç»„ï¼ˆMetagenomeï¼‰æ˜¯æŒ‡å¯¹ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ‰€æœ‰å¾®ç”Ÿç‰©è¿›è¡ŒDNAåˆ†æçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§ã€åŠŸèƒ½å’Œäº’ä½œå…³ç³»ã€‚è¿™é‡Œä»‹ç»å¸¸ç”¨çš„ä¸Šæ¸¸åˆ†ææµç¨‹ã€‚"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://jb-cao.github.io/Cao-blog/p/metagenomic-workflow/images/workflow.png' />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">
<link rel="shortcut icon" href="favicon/android-chrome-512x512.png" />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/Cao-blog/">
                
                    
                    
                    
                        
                        <img src="/Cao-blog/img/guodong1_hu_72aa525a63157f1a.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ›ğŸ¶</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/Cao-blog">Cao&#39;s blog</a></h1>
            <h2 class="site-description">work hard, live happily.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/472862038'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/JB-Cao'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/Cao-blog/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/mindmap/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-sitemap"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M15 15m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M6 15v-1a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v1" /><path d="M12 9l0 3" /></svg>
                
                <span>Mindmap</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Cao-blog/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://jb-cao.github.io/Cao-blog/" selected>English</option>
                        
                            <option value="https://jb-cao.github.io/Cao-blog/zh-cn/" >ä¸­æ–‡</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#logs">Logs</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#preprocess">preprocess</a>
      <ol>
        <li><a href="#è´¨æ§fastp">è´¨æ§ï¼šfastp</a></li>
        <li><a href="#å»å®¿ä¸»">å»å®¿ä¸»</a>
          <ol>
            <li><a href="#bowtie2">bowtie2</a></li>
            <li><a href="#bwa-mem2">bwa-mem2</a></li>
          </ol>
        </li>
        <li><a href="#fastqä¿¡æ¯ç»Ÿè®¡">fastqä¿¡æ¯ç»Ÿè®¡</a></li>
      </ol>
    </li>
    <li><a href="#reads-based">reads-based</a>
      <ol>
        <li><a href="#ç‰©ç§æ³¨é‡Škraken2">ç‰©ç§æ³¨é‡Šï¼škraken2</a>
          <ol>
            <li><a href="#krakenè¾“å‡ºæ ¼å¼">Krakenè¾“å‡ºæ ¼å¼</a></li>
          </ol>
        </li>
        <li><a href="#ç‰©ç§åŠŸèƒ½humann">ç‰©ç§+åŠŸèƒ½ï¼šHUMAnN</a></li>
      </ol>
    </li>
    <li><a href="#contigs-based">contigs-based</a>
      <ol>
        <li><a href="#ç»„è£…assembly">ç»„è£…ï¼ˆassemblyï¼‰</a>
          <ol>
            <li><a href="#megahit">megahit</a></li>
            <li><a href="#metaspades">metaSPAdes</a></li>
          </ol>
        </li>
        <li><a href="#ç»„è£…è¯„ä¼°quast">ç»„è£…è¯„ä¼°ï¼šQUAST</a></li>
        <li><a href="#åŸºå› é¢„æµ‹prodigal">åŸºå› é¢„æµ‹ï¼šProdigal</a></li>
        <li><a href="#å»å†—ä½™">å»å†—ä½™</a>
          <ol>
            <li><a href="#cd-hit">CD-HIT</a></li>
            <li><a href="#mmseqs2">Mmseqs2</a></li>
          </ol>
        </li>
        <li><a href="#fastaä¿¡æ¯ç»Ÿè®¡">fastaä¿¡æ¯ç»Ÿè®¡</a></li>
        <li><a href="#åŸºå› å®šé‡salmon">åŸºå› å®šé‡ï¼šsalmon</a></li>
        <li><a href="#åŠŸèƒ½åŸºå› æ³¨é‡Š">åŠŸèƒ½åŸºå› æ³¨é‡Š</a>
          <ol>
            <li><a href="#eggnog-cogkeggcazy">eggNOG (COG/KEGG/CAZy)</a></li>
            <li><a href="#dbcan2ç¢³æ°´åŒ–åˆç‰©">dbCAN2ï¼ˆç¢³æ°´åŒ–åˆç‰©ï¼‰</a></li>
            <li><a href="#cardæŠ—ç”Ÿç´ æŠ—æ€§åŸºå› args">CARDï¼ˆæŠ—ç”Ÿç´ æŠ—æ€§åŸºå› ARGsï¼‰</a></li>
            <li><a href="#vfdbæ¯’åŠ›å› å­">VFDBï¼ˆæ¯’åŠ›å› å­ï¼‰</a></li>
            <li><a href="#å…¶ä»–æ•°æ®åº“">å…¶ä»–æ•°æ®åº“</a></li>
          </ol>
        </li>
        <li><a href="#åŠŸèƒ½æ³¨é‡Šåˆå¹¶">åŠŸèƒ½æ³¨é‡Šåˆå¹¶</a></li>
      </ol>
    </li>
    <li><a href="#åˆ†ç®±binning">åˆ†ç®±ï¼ˆbinningï¼‰</a></li>
    <li><a href="#reference">Reference</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/Cao-blog/p/metagenomic-workflow/">
                <img src="/Cao-blog/p/metagenomic-workflow/images/workflow_hu_9d0727389e8f6507.png"
                        srcset="/Cao-blog/p/metagenomic-workflow/images/workflow_hu_9d0727389e8f6507.png 800w, /Cao-blog/p/metagenomic-workflow/images/workflow_hu_e31f75347f7b8ef2.png 1600w"
                        width="800" 
                        height="465" 
                        loading="lazy"
                        alt="Featured image of post å®åŸºå› ç»„åˆ†ææµç¨‹ï¼ˆMetagenomic workflowï¼‰202408ï½œæŒç»­æ›´æ–°" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/Cao-blog/categories/metagenomic/" style="background-color: #8dd3c7; color: #fff;">
                metagenomic
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/Cao-blog/p/metagenomic-workflow/">å®åŸºå› ç»„åˆ†ææµç¨‹ï¼ˆMetagenomic workflowï¼‰202408ï½œæŒç»­æ›´æ–°</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            å®åŸºå› ç»„ï¼ˆMetagenomeï¼‰æ˜¯æŒ‡å¯¹ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ‰€æœ‰å¾®ç”Ÿç‰©è¿›è¡ŒDNAåˆ†æçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§ã€åŠŸèƒ½å’Œäº’ä½œå…³ç³»ã€‚è¿™é‡Œä»‹ç»å¸¸ç”¨çš„ä¸Šæ¸¸åˆ†ææµç¨‹ã€‚
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 28, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    15 minute read
                </time>
            </div>
        
        
        

           <div>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



              <time class="article-words">
                ç‰ˆæƒå½’Cao's blogæ‰€æœ‰ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„
              </time>
           </div>
        
    </footer>
    
    
    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="logs">Logs</h2>
<ul>
<li>å¢åŠ ä½¿ç”¨bwa-mem2å»å®¿ä¸»ï¼Œå¯ä»¥å»å¾—æ›´å¹²å‡€ã€‚é€‚äºå®¿ä¸»åºåˆ—å¾ˆé«˜ï¼Œå®³æ€•å‡é˜³æ€§ç»“æœçš„æƒ…å†µã€‚ï¼ˆ2024.07.15ï¼‰</li>
<li>æ›´æ–°å…¨æ–‡ç»†èŠ‚ï¼ˆ2024.05.29ï¼‰</li>
<li>å¢åŠ Mmseqs2ç”¨äºå»å†—ä½™ï¼ŒåŸºå› èšç±»çš„é€Ÿåº¦éå¸¸å¿«ï¼Œä¸”éšåºåˆ—é‡çº¿æ€§å¢é•¿ï¼ˆ2024.03.12ï¼‰</li>
<li>å¢åŠ RåŒ…<code>pctax</code>å†…çš„ä¸€äº›å¸®åŠ©ä¸Šæ¸¸åˆ†æçš„å°è„šæœ¬ï¼ˆ2024.03.03ï¼‰</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>
<p>ç¯‡å¹…æœ‰é™ï¼Œæœ¬æ–‡ä¸€èˆ¬ä¸ä»‹ç»å…·ä½“çš„è½¯ä»¶å®‰è£…é…ç½®ï¼Œæ•°æ®åº“ä¸‹è½½ç­‰ï¼Œä¹Ÿä¸æä¾›ç¤ºä¾‹æ•°æ®ï¼Œä¸»è¦å¸®åŠ©å¿«é€Ÿäº†è§£æ•´ä¸ªå®åŸºå› ç»„çš„<strong>ä¸Šæ¸¸åˆ†æ</strong>æµç¨‹ã€‚æ‰€ä»¥è½¯ä»¶å®‰è£…è¯·å‚è€ƒè½¯ä»¶è‡ªèº«ä»‹ç»ï¼Œè¿è¡Œæ—¶é‡åˆ°å…·é—®é¢˜ä¹Ÿæœ€å¥½å…ˆGoogleæˆ–è€…å»github issueé‡Œé¢é—®é—®ã€‚</p>
</li>
<li>
<p>å®åŸºå› ç»„åˆ†ææŠ€æœ¯è¿˜æ˜¯åœ¨ä¸åœçš„æ›´æ–°è¿­ä»£ï¼Œå¾ˆå¤šæ›´æ–°æ›´å¥½ç”¨çš„è½¯ä»¶åœ¨ä¸æ–­æ¨å‡ºï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™ä¹Ÿä¼šæŒç»­æ›´æ–°ï¼ˆå¦‚æœæˆ‘è¿˜ä¸€ç›´åšè¿™ä¸ªæ–¹å‘çš„è¯ï¼‰ã€‚è¿™é‡Œä»‹ç»çš„ä¹Ÿåªæ˜¯æ¯”è¾ƒåŸºæœ¬çš„åˆ†ææµç¨‹ï¼Œä½†æ˜¯æŒæ¡äº†ä¹‹åï¼Œè‡ªå·±è¿›ä¸€æ­¥å»åšä¸ªæ€§åŒ–åˆ†æä¹Ÿä¼šé¡ºæ‰‹å¾ˆå¤šã€‚</p>
</li>
<li>
<p>å®Œæˆä¸Šæ¸¸åˆ†æåæˆ‘ä»¬å¯ä»¥å¾—åˆ°å„ç§ç‰©ç§æˆ–è€…åŠŸèƒ½çš„profileï¼Œåç»­ä¸€èˆ¬ç”¨pythonï¼ŒRè¿›è¡Œæ•°æ®åˆ†æå’Œå¯è§†åŒ–ï¼Œå¯å‚è€ƒæˆ‘çš„å…¶ä»–åšæ–‡ã€‚</p>
</li>
<li>
<p>ç»å¤§å¤šæ•°è¿™é‡Œä»‹ç»çš„è½¯ä»¶éƒ½æ˜¯ä»…æ”¯æŒlinuxå¹³å°çš„ï¼Œæˆ‘ä»¬åšæµ‹åºæ–‡ä»¶ä¸Šæ¸¸åˆ†æä¹Ÿè‚¯å®šæ˜¯åœ¨æœåŠ¡å™¨ä¸Šåšï¼Œä¸ªäººPCä¸€èˆ¬å¾ˆéš¾æ»¡è¶³éœ€æ±‚ï¼Œæ‰€ä»¥åœ¨åšè¿™äº›åˆ†æå‰å¿…é¡»å…ˆå­¦ä¹ linuxåŸºç¡€çŸ¥è¯†å¦‚æ–‡ä»¶ç³»ç»Ÿï¼Œshellè„šæœ¬ç¼–å†™ï¼Œè½¯ä»¶å®‰è£…ç­‰ã€‚å®‰è£…è½¯ä»¶å»ºè®®ä½¿ç”¨condaæˆ–mambaï¼ˆæ–°å»ºç¯å¢ƒå’Œç®¡ç†ï¼‰ï¼Œæœ‰å¾ˆå¤šå‚è€ƒæ–¹æ³•ã€‚</p>
</li>
<li>
<p>æˆ‘ä½¿ç”¨çš„é›†ç¾¤æ˜¯slurmä½œä¸šç®¡ç†ç³»ç»Ÿï¼Œä¸‹é¢çš„ç¤ºä¾‹è„šæœ¬ä¹Ÿæ˜¯é€‚ç”¨ä¸slurmçš„ï¼Œå°½é‡å…ˆå­¦ä¹ ä¸€ä¸‹<a class="link" href="../slurm" >slurmçš„ä½¿ç”¨</a>å†å°è¯•æäº¤ä½œä¸šã€‚å¦‚æœä¸ç”¨slurmçš„è¯å¯ä»¥åªå‚è€ƒ<code>#############</code>ä¸­é—´çš„è½¯ä»¶éƒ¨åˆ†ã€‚</p>
</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>å®åŸºå› ç»„ï¼ˆMetagenomeï¼‰æ˜¯æŒ‡å¯¹ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ‰€æœ‰å¾®ç”Ÿç‰©è¿›è¡ŒDNAåˆ†æçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§ã€åŠŸèƒ½å’Œäº’ä½œå…³ç³»ã€‚</p>
<p>å®åŸºå› ç»„çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>ç”Ÿç‰©å¤šæ ·æ€§ç ”ç©¶ï¼šé€šè¿‡å¯¹å®åŸºå› ç»„è¿›è¡Œåˆ†æï¼Œå¯ä»¥äº†è§£ä¸åŒç”Ÿæ€ç³»ç»Ÿä¸­å¾®ç”Ÿç‰©çš„å¤šæ ·æ€§å’Œåˆ†å¸ƒæƒ…å†µã€‚</li>
<li>ç”Ÿæ€å­¦ç ”ç©¶ï¼šå®åŸºå› ç»„å¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜äº†è§£å¾®ç”Ÿç‰©åœ¨ç”Ÿæ€ç³»ç»Ÿä¸­çš„åŠŸèƒ½ã€äº’ä½œå…³ç³»å’Œç”Ÿæ€ä½ç­‰ã€‚</li>
<li>ç”Ÿç‰©æŠ€æœ¯ï¼šå®åŸºå› ç»„å¯ä»¥ç”¨äºç­›é€‰å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„å¾®ç”Ÿç‰©ï¼Œä¾‹å¦‚ï¼Œå¯»æ‰¾èƒ½å¤Ÿé™è§£æœ‰å®³ç‰©è´¨çš„å¾®ç”Ÿç‰©ã€‚</li>
</ul>
<p>å®åŸºå› ç»„çš„åˆ†æä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>DNAæå–ä¸å»ºåº“ã€‚</li>
<li>é«˜é€šé‡æµ‹åºï¼šä½¿ç”¨é«˜é€šé‡æµ‹åºæŠ€æœ¯å¯¹æ‰©å¢åçš„DNAè¿›è¡Œæµ‹åºï¼Œå¾—åˆ°åŸå§‹åºåˆ—æ•°æ®ã€‚</li>
<li>æ•°æ®æ¸…æ´—å’Œç»„è£…ï¼šå¯¹åŸå§‹æ•°æ®è¿›è¡Œè´¨é‡æ§åˆ¶ã€å»é™¤ä½è´¨é‡åºåˆ—å’Œå†—ä½™åºåˆ—ï¼Œå°†åºåˆ—æ‹¼æ¥æˆè¾ƒé•¿çš„è¿ç»­åºåˆ—ï¼ˆcontigsï¼‰ã€‚</li>
<li>åŸºå› æ³¨é‡Šï¼šå°†contigsä¸­çš„åŸºå› è¿›è¡Œæ³¨é‡Šï¼Œå¾—åˆ°åŸºå› åŠŸèƒ½ä¿¡æ¯ã€‚</li>
<li>æ•°æ®åˆ†æï¼šäº†è§£å¾®ç”Ÿç‰©å¤šæ ·æ€§ã€ç¾¤è½ç»“æ„ã€åŠŸèƒ½ç‰¹å¾ç­‰ä¿¡æ¯ï¼ˆæ›´å¤šæ˜¯æŒ‡è·å–äº†ç‰©ç§ä¸°åº¦è¡¨æˆ–åŠŸèƒ½ä¸°åº¦è¡¨ä¹‹åçš„è¿›ä¸€æ­¥åˆ†æï¼‰ã€‚</li>
<li>MAGs binningï¼Œ è¿›åŒ–åŠ¨æ€ç­‰è¿›ä¸€æ­¥åˆ†æ</li>
</ol>
<p>ä¸‹å›¾æ˜¯æˆ‘å¸¸ç”¨çš„ä¸€å¥—ä¸Šæ¸¸åŸºæœ¬æµç¨‹ï¼Œå½“ç„¶åœ¨é¢å¯¹ä¸åŒé¡¹ç›®æ—¶åº”è¯¥æœ‰ä¸åŒçš„ä¾§é‡ç‚¹å’Œé€‚ç”¨çš„åˆ†ææ–¹æ³•ï¼Œå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ æˆ–ä¿®æ”¹ã€‚</p>
<p>æœ€æ—©çš„æ—¶å€™ï¼Œè¿™æ–¹é¢çš„åˆ†ææˆ‘éƒ½æ˜¯å‚è€ƒåˆ˜æ°¸é‘«è€å¸ˆçš„<a class="link" href="https://github.com/YongxinLiu/EasyMetagenome"  target="_blank" rel="noopener"
    ><strong>EasyMetagenome</strong></a>ï¼Œç°åœ¨è¿™å¥—æµç¨‹ä¹Ÿå‘æ–‡ç« äº† (<a class="link" href="#ref-liuPracticalGuideAmplicon2021" ><em>1</em></a>)ï¼Œå€¼å¾—å‚è€ƒï¼Œå¯¹ä¸Šæ‰‹16Sæµ‹åºæ•°æ®æˆ–å®åŸºå› ç»„æ•°æ®éƒ½å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<img src="images/workflow.png" title=""/>
<p>æœ€è¿‘ï¼ˆ2024.3.3ï¼‰æˆ‘æ•´ç†äº†ä¸€ä¸‹æµç¨‹æ”¾åœ¨æˆ‘çš„RåŒ…<code>pctax</code>é‡Œäº†ï¼Œæ–¹ä¾¿æ•´ä¸ªå®åŸºå› ç»„çš„ä¸Šä¸‹æ¸¸æµç¨‹ç»“åˆï¼š</p>
<img src="images/pctax_workflow.png" title=""/>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;pctax&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ä½¿ç”¨micro_sbatchå¯ä»¥å¿«é€Ÿè·å¾—æ¯ä¸€æ­¥çš„slurmè„šæœ¬ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">pctax</span><span class="o">::</span><span class="nf">micro_sbatch</span><span class="p">(</span><span class="n">work_dir</span> <span class="o">=</span> <span class="s">&#34;~/work/&#34;</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="s">&#34;fastp&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="preprocess">preprocess</h2>
<p>ä¸€èˆ¬æŠŠæ‰€æœ‰æ ·æœ¬çš„æµ‹åºåŒç«¯æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªdataæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åæŠŠæ‰€æœ‰æ ·æœ¬åå†™å…¥åˆ°ä¸€ä¸ª<code>samplelist</code>æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿åç»­å„ç§è½¯ä»¶çš„æ‰¹é‡æ“ä½œã€‚</p>
<h3 id="è´¨æ§fastp">è´¨æ§ï¼šfastp</h3>
<p>æµ‹åºæ–‡ä»¶è´¨æ§æ˜¯æŒ‡åœ¨ä¸‹æ¸¸åˆ†æå‰å¯¹æµ‹åºæ•°æ®è¿›è¡Œè´¨é‡æ§åˆ¶å’Œæ¸…ç†ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p>
<p>fastpæ˜¯ä¸€ä¸ªéå¸¸å¿«é€Ÿã€å¤šåŠŸèƒ½çš„æµ‹åºæ•°æ®è´¨æ§å·¥å…·ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–çš„è´¨æ§å¤„ç†ï¼ŒåŒ…æ‹¬å»é™¤ä½è´¨é‡åºåˆ—ã€å‰ªåˆ‡æ¥å¤´åºåˆ—å’Œç”Ÿæˆè´¨æ§æŠ¥å‘Šã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=fastp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p data/fastp
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/fastp -w <span class="m">8</span> -i data/rawdata/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_f1.fastq.gz -o data/fastp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_1.fq.gz <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -I data/rawdata/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_r2.fastq.gz -O data/fastp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_2.fq.gz -j data/fastp/<span class="si">${</span><span class="nv">i</span><span class="si">}</span>.json
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><p>fastpçš„jsonæ–‡ä»¶ä¸­ç»Ÿè®¡äº†æµ‹åºæ•°æ®çš„åŸºæœ¬æŒ‡æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ•´ç†ä¸ºè¡¨æ ¼ï¼š
æŠŠæ‰€æœ‰çš„.jsonæ–‡ä»¶ç§»åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œreport/ä¸‹ï¼Œä½¿ç”¨æˆ‘å†™çš„RåŒ…<code>pctax</code>è¯»å–jsonæ–‡ä»¶å¹¶æ•´ç†æˆè¡¨æ ¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">pctax</span><span class="o">::</span><span class="nf">pre_fastp</span><span class="p">(</span><span class="s">&#34;report/&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦å¤–ï¼ŒFastQCï¼ŒCutadaptï¼ŒTrimmomaticç­‰ä¹Ÿæ˜¯å¸¸ç”¨çš„æµ‹åºè´¨æ§å·¥å…·ã€‚</p>
<h3 id="å»å®¿ä¸»">å»å®¿ä¸»</h3>
<p>å»å®¿ä¸»çš„è¿‡ç¨‹å…¶å®å°±æ˜¯å°†åºåˆ—æ¯”å¯¹åˆ°å®¿ä¸»åŸºå› ç»„ä¸Šï¼Œç„¶åæ²¡æœ‰æ¯”å¯¹åˆ°çš„åºåˆ—æ•´åˆæˆæ–°æ–‡ä»¶å°±æ˜¯å»å®¿ä¸»åçš„äº†ã€‚</p>
<h4 id="bowtie2">bowtie2</h4>
<p>å®¿ä¸»åŸºå› ç»„éœ€è¦è‡ªå·±å…ˆä¸‹è½½å¥½å¹¶ç”¨ bowtie2-build å»ºç«‹ç´¢å¼•ï¼Œä»¥äººç±»ä¸ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=rm_human</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p data/rm_human
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/bowtie2 -p <span class="m">8</span> -x ~/db/humangenome/hg38 -1 data/fastp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_1.fq.gz <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -2 data/fastp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_2.fq.gz -S data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.sam <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --un-conc data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.fq --very-sensitive
</span></span><span class="line"><span class="cl">  rm data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.sam
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ®è¯´bowtie2çš„æ•æ„Ÿæ€§æ¯”è¾ƒä½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå·²ç»æ‰“å¼€äº†<code>--very-sensitive</code>æ¨¡å¼ã€‚
æ•æ„Ÿåº¦ä¸è¶³ä¼šå¯¼è‡´æœ‰äº›å¯èƒ½æ˜¯äººç±»åºåˆ—ä½†ä¸ä¼šæ¯”å¯¹åˆ°genomeä¸Šè€Œå¯¼è‡´ç»“æœè¿˜æœ‰äººç±»åºåˆ—ï¼ˆ<a class="link" href="https://mp.weixin.qq.com/s/Qxj0PvVn49ynrD5jVxucTw"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/Qxj0PvVn49ynrD5jVxucTw</a>ï¼‰ï¼Œå¯ä»¥ç”¨ä½¿ç”¨bwa-memï¼Œæˆ–è€…åœ¨åç»­krakenä¸­ä½¿ç”¨å¸¦æœ‰äººç±»genomeçš„æ•°æ®åº“è¿›ä¸€æ­¥å»é™¤å®¿ä¸»ã€‚</p>
<h4 id="bwa-mem2">bwa-mem2</h4>
<p>bwa-mem2çš„æ•æ„Ÿåº¦è¾ƒé«˜ï¼ˆ<a class="link" href="https://hc1023.github.io/2020/11/03/extract-paired-mapping-reads-and-flagstat/"  target="_blank" rel="noopener"
    >https://hc1023.github.io/2020/11/03/extract-paired-mapping-reads-and-flagstat/</a>ï¼‰ã€‚</p>
<p>æˆ‘æ‹¿äº†ä¸€ä¸ªæ ·æœ¬è¯•äº†ä¸‹ï¼ŒåŸå§‹readsæœ‰10,260,663æ¡ï¼Œbowtie2è¿‡æ»¤æœ‰9,441,462æ¡ï¼Œbwa-memè¿‡æ»¤æ‰åªæœ‰6,520,171æ¡ï¼Œbwa-memæ˜¯å®å¯é”™æ€1000ï¼Œä¸æ”¾è¿‡ä¸€ä¸ªã€‚</p>
<p>å®¿ä¸»åŸºå› ç»„éœ€è¦è‡ªå·±å…ˆä¸‹è½½å¥½å¹¶ç”¨ bwa-mem2 index å»ºç«‹ç´¢å¼•ï¼Œä»¥äººç±»ä¸ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=rm_human</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># bwa-mem2 index ~/db/humangenome/hg38.fa #70Gå†…å­˜ï¼Œ1300s</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p data/rm_human
</span></span><span class="line"><span class="cl">  bwa-mem2 mem -t <span class="m">8</span> ~/db/humangenome/hg38.fa data/fastp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_1.fq.gz <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    data/fastp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_2.fq.gz &gt; data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_aligned_reads.sam <span class="c1"># 20Gå†…å­˜ï¼Œ8æ ¸ï¼Œ419s</span>
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/samtools view -Sb data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_aligned_reads.sam &gt; data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_reads.bam
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/samtools sort data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_reads.bam data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_sorted_reads
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/samtools view -b -f <span class="m">4</span> data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_sorted_reads.bam &gt; data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_non_host_reads.bam
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/bedtools bamtofastq -i data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_non_host_reads.bam -fq data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.1.fq -fq2 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.2.fq
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  rm data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_aligned_reads.sam
</span></span><span class="line"><span class="cl">  rm data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_reads.bam
</span></span><span class="line"><span class="cl">  rm data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_sorted_reads.bam
</span></span><span class="line"><span class="cl">  rm data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_non_host_reads.bam
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fastqä¿¡æ¯ç»Ÿè®¡">fastqä¿¡æ¯ç»Ÿè®¡</h3>
<p>å¯ä»¥ç”¨ä¸€äº›å°å·¥å…·å¦‚FastqCountï¼Œseqkitç­‰æ¥ç»Ÿè®¡readsæ•°ï¼Œç¢±åŸºæ•°ï¼ŒGCï¼ŒQ20ï¼ŒQ30ç­‰æŒ‡æ ‡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~/biosoft/FastqCount-master/FastqCount_v0.5 xx.fastq.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Total Reads     Total Bases     N Bases Q20     Q30     GC
</span></span><span class="line"><span class="cl"><span class="m">11568822</span> <span class="o">(</span>11.57 M<span class="o">)</span>      <span class="m">1702829127</span> <span class="o">(</span>1.70 G<span class="o">)</span>     0.00%   98.00%  94.00%  54.00%
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿˜å¯ä»¥æŠŠcleandataå†è·‘ä¸€ä¸‹fastpğŸ˜‚ï¼Œä½†æ˜¯åªçœ‹å¤„ç†å‰çš„ç»Ÿè®¡æŒ‡æ ‡ã€‚å› ä¸ºfastpç¡®å®éå¸¸å¿«ï¼Œçº¯ç²¹ç”¨æ¥ç»Ÿè®¡ä¹Ÿè¡Œã€‚</p>
<h2 id="reads-based">reads-based</h2>
<p>reads-basedå®åŸºå› ç»„åˆ†ææ˜¯æŒ‡ç›´æ¥åˆ©ç”¨æµ‹åºè¯»é•¿ï¼ˆreadsï¼‰è¿›è¡Œå®åŸºå› ç»„æ•°æ®åˆ†æçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯å…ˆè¿›è¡ŒåŸºå› ç»„ç»„è£…ã€‚è¯¥æ–¹æ³•é€šè¿‡å¯¹çŸ­è¯»é•¿è¿›è¡Œæ¯”å¯¹å’Œæ³¨é‡Šï¼Œä»ä¸­æå–åŠŸèƒ½ä¿¡æ¯å’Œç‰©ç§ç»„æˆï¼Œå¸¸ç”¨äºå¿«é€Ÿè¯„ä¼°ç¯å¢ƒæ ·æœ¬ä¸­çš„å¾®ç”Ÿç‰©ç¾¤è½ç»“æ„å’ŒåŠŸèƒ½æ½œåŠ›ã€‚</p>
<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼š
<ul>
<li><strong>å¿«é€Ÿ</strong>ï¼šæ— éœ€ç»„è£…ï¼Œå¤„ç†é€Ÿåº¦è¾ƒå¿«ã€‚</li>
<li><strong>å…¨é¢</strong>ï¼šèƒ½å¤Ÿæ£€æµ‹åˆ°ä½ä¸°åº¦çš„å¾®ç”Ÿç‰©å’ŒåŠŸèƒ½åŸºå› ï¼Œé€‚åˆå¤§è§„æ¨¡æ ·æœ¬åˆ†æã€‚</li>
</ul>
</li>
<li><strong>å±€é™æ€§</strong>ï¼š
<ul>
<li><strong>ç‰‡æ®µåŒ–</strong>ï¼šç”±äºä¸è¿›è¡Œç»„è£…ï¼Œåˆ†æåŸºäºçŸ­è¯»é•¿ï¼Œå¯èƒ½ä¼šé”™è¿‡é•¿è·ç¦»çš„åŸºå› è”ç³»å’Œç»“æ„ä¿¡æ¯ã€‚</li>
<li><strong>ä¾èµ–æ•°æ®åº“</strong>ï¼šåˆ†æç»“æœä¾èµ–äºå‚è€ƒæ•°æ®åº“çš„å…¨é¢æ€§å’Œå‡†ç¡®æ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 id="ç‰©ç§æ³¨é‡Škraken2">ç‰©ç§æ³¨é‡Šï¼škraken2</h3>
<p>Kraken2æ˜¯ä¸€ä¸ªç”¨äºå¯¹é«˜é€šé‡æµ‹åºæ•°æ®è¿›è¡Œåˆ†ç±»å’Œæ ‡è¯†ç‰©ç§çš„è½¯ä»¶ã€‚å®ƒä½¿ç”¨å‚è€ƒæ•°æ®åº“ä¸­çš„åŸºå› ç»„åºåˆ—æ¥è¿›è¡Œåˆ†ç±»ï¼Œå¹¶ä½¿ç”¨k-meræ–¹æ³•æ¥å®ç°å¿«é€Ÿå’Œå‡†ç¡®çš„åˆ†ç±»ã€‚</p>
<p>ä½¿ç”¨Kraken2è¿›è¡ŒåŸºæœ¬åˆ†ç±»çš„ç®€å•æ­¥éª¤ï¼š</p>
<ol>
<li>å‡†å¤‡å‚è€ƒæ•°æ®åº“ï¼šKraken2éœ€è¦ä¸€ä¸ªå‚è€ƒæ•°æ®åº“ï¼Œä»¥ä¾¿å¯¹æµ‹åºæ•°æ®è¿›è¡Œåˆ†ç±»ã€‚å¯ä»¥ç›´æ¥ä¸‹è½½å®˜æ–¹æ„å»ºçš„æ ‡å‡†åº“ï¼Œä¹Ÿå¯ä»¥ä»NCBIã€Ensemblæˆ–å…¶ä»–æ•°æ®åº“ä¸‹è½½ç›¸åº”çš„åŸºå› ç»„åºåˆ—ï¼Œå¹¶ä½¿ç”¨Kraken2å†…ç½®çš„å·¥å…·æ¥æ„å»ºæ•°æ®åº“ã€‚</li>
</ol>
<p><code>kraken2-build --standard --threads 24 --db ./</code></p>
<p><code>--standard</code>æ ‡å‡†æ¨¡å¼ä¸‹åªä¸‹è½½5ç§æ•°æ®åº“ï¼šå¤èŒarchaeaã€ç»†èŒbacteriaã€äººç±»humanã€è½½ä½“UniVec_Coreã€ç—…æ¯’viralã€‚</p>
<ol start="2">
<li>
<p>å®‰è£…Kraken2ï¼šå¯ä»¥ä»Kraken2å®˜æ–¹ç½‘ç«™ä¸‹è½½å¹¶å®‰è£…Kraken2è½¯ä»¶ã€‚</p>
</li>
<li>
<p>è¿è¡ŒKraken2ï¼šä½¿ç”¨Kraken2å¯¹æµ‹åºæ•°æ®è¿›è¡Œåˆ†ç±»éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
</li>
</ol>
<p><code>kraken2 --db &lt;path_to_database&gt; &lt;input_file&gt; --output &lt;output_file&gt;</code></p>
<p>è¿™é‡Œï¼Œ<code>&lt;path_to_database&gt;</code>æ˜¯å‚è€ƒæ•°æ®åº“çš„è·¯å¾„ï¼Œ<code>&lt;input_file&gt;</code>æ˜¯éœ€è¦è¿›è¡Œåˆ†ç±»çš„è¾“å…¥æ–‡ä»¶ï¼Œ<code>&lt;output_file&gt;</code>æ˜¯è¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚Kraken2å°†è¾“å‡ºä¸€ä¸ªåˆ†ç±»æŠ¥å‘Šæ–‡ä»¶å’Œä¸€ä¸ªåºåˆ—æ–‡ä»¶ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯krakenè¿è¡Œè‡³å°‘è¦æä¾›æ•°æ®åº“å¤§å°çš„å†…å­˜å¤§å°ï¼ˆè¿è¡Œå†…å­˜ï¼‰ï¼Œå› ä¸ºå®ƒä¼šæŠŠæ•´ä¸ªæ•°æ®åº“è½½å…¥å†…å­˜åè¿›è¡Œåºåˆ—çš„æ³¨é‡Šï¼Œæ‰€ä»¥å¦‚æœå‘ç°æ— æ³•è½½å…¥æ•°æ®åº“çš„æŠ¥é”™ï¼Œå¯ä»¥å°è¯•è°ƒå¤§å†…å­˜èµ„æºã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=kraken2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=40G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/kraken2
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/kraken2 --threads <span class="m">8</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --db ~/db/kraken2/stand_krakenDB <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --confidence 0.05 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --output result/kraken2/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.output <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --report result/kraken2/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.kreport <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --paired <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.1.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.2.fq
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦å¤–ï¼Œkrakenæ•°æ®åº“æ˜¯å¯ä»¥è‡ªå·±æ„å»ºçš„ï¼Œæ‰€ä»¥é€‚ç”¨äºå„ç§é¡¹ç›®çš„ç‰©ç§æ³¨é‡Šï¼Œæˆ‘åšçš„æ¯”è¾ƒå¤šçš„æ˜¯ç¯å¢ƒæ ·æœ¬çš„å®åŸºå› ç»„ï¼Œå°±å¯èƒ½éœ€è¦æ›´å…¨é¢çš„ç‰©ç§æ•°æ®åº“ï¼ˆç”šè‡³é™¤äº†å„ç§å¾®ç”Ÿç‰©ï¼Œè¿˜è¦åŠ¨æ¤ç‰©æ•°æ®ç­‰ï¼‰ï¼Œæˆ‘ä»¬å®éªŒå®¤çš„WXå¸ˆå§æ”¶é›†æ„å»ºäº†ä¸€ä¸ªè¶…å¤§çš„ç‰©ç§åº“ã€‚</p>
<p>krakenè½¯ä»¶è¿è¡Œæ—¶è½½å…¥æ•°æ®åº“æ˜¯ä¸€ä¸ªååˆ†è€—æ—¶çš„æ­¥éª¤ï¼Œè€Œæ¯æ¡åºåˆ—çš„é‰´å®šæ—¶é—´å·®ä¸å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å¾ˆå¤šæ ·æœ¬çš„fastqæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªå¤§æ–‡ä»¶åè¾“å…¥krakenæ³¨é‡Šï¼Œä¹‹åå†æŒ‰ç…§åºåˆ—çš„æ•°é‡æ‹†åˆ†ç»“æœæ–‡ä»¶ï¼Œè¿™æ ·å¤šä¸ªæ ·æœ¬ä¹Ÿåªéœ€è¦è½½å…¥ä¸€æ¬¡æ•°æ®åº“ï¼ŒèŠ‚çœæ—¶é—´ï¼Œä»¥ä¸‹æ˜¯ç”¨è‡ªå®šä¹‰çš„kraken2M.pyè„šæœ¬å®ç°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=kraken2M</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/kraken/%x_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/kraken/%x_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --time=14-00:00:00</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=mem</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=32</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=100G</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  mkdir -p result/kraken
</span></span><span class="line"><span class="cl">  python /share/home/jianglab/shared/krakenDB/K2ols/kraken2M.py -t <span class="m">16</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -i data/rm_human <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -c 0.05 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -s .1.fq,.2.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -o result/kraken <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -d /share/home/jianglab/shared/krakenDB/mydb2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -k ~/miniconda3/envs/waste/bin/kraken2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -kt /share/home/jianglab/shared/krakenDB/K2ols/KrakenTools
</span></span><span class="line"><span class="cl">  mkdir -p result/kraken/kreport
</span></span><span class="line"><span class="cl">  mv result/kraken/*_kreport.txt result/kraken/kreport/
</span></span><span class="line"><span class="cl">  python ~/db/script/format_kreports.py -i result/kraken/kreport <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -kt /share/home/jianglab/shared/krakenDB/K2ols/KrakenTools --save-name2taxid
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="krakenè¾“å‡ºæ ¼å¼">Krakenè¾“å‡ºæ ¼å¼</h4>
<p>æ ‡å‡†è¾“å‡ºæ ¼å¼outputæ–‡ä»¶(äº”åˆ—è¡¨):</p>
<ul>
<li>C/Uä»£è¡¨åˆ†ç±»classifiedæˆ–éåˆ†ç±»unclassifed</li>
<li>åºåˆ—ID</li>
<li>ç‰©ç§æ³¨é‡Š</li>
<li>æ¯”åºåˆ—æ³¨é‡Šçš„åŒºåŸŸï¼Œå¦‚98|94ä»£è¡¨å·¦ç«¯98bpï¼Œå³ç«¯94bpæ¯”å¯¹è‡³æ•°æ®åº“</li>
<li>LCAæ¯”å¯¹ç»“æœï¼Œå¦‚â€562:13 561:4â€ä»£è¡¨13 k-meræ¯”å¯¹è‡³ç‰©ç§#562ï¼Œ4 k-meræ¯”å¯¹è‡³#561ç‰©ç§</li>
</ul>
<p>æŠ¥å‘Šè¾“å‡ºæ ¼å¼reportæ–‡ä»¶(åŒ…æ‹¬6åˆ—ï¼Œæ–¹ä¾¿æ•´ç†ä¸‹æ¸¸åˆ†æ):</p>
<ol>
<li>ç™¾åˆ†æ¯”</li>
<li>count</li>
<li>countæœ€ä¼˜</li>
<li>(U)nclassified, (R)oot, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies. â€œG2â€ä»£è¡¨ä½äºå±ä¸€ç§é—´</li>
<li>NCBIç‰©ç§ID</li>
<li>ç§‘å­¦ç‰©ç§å</li>
</ol>
<p>å¸¸ç”¨çš„ç‰©ç§ä¸°åº¦è¡¨æ ¼å¼é™¤äº†kraken reportï¼Œè¿˜æœ‰mpaï¼Œspfï¼Œkronaç­‰æ ¼å¼ï¼Œå…³äºkrakenç»“æœçš„æ•´ç†ä»¥åŠæ ¼å¼è½¬æ¢æ–¹å¼ï¼Œæœ‰ä¸€äº›ç°æˆçš„è„šæœ¬æˆ–è€…è‡ªå·±å†™ã€‚</p>
<p><a class="link" href="https://ccb.jhu.edu/software/krakentools/"  target="_blank" rel="noopener"
    >KrakenTools (jhu.edu)</a> å°±æ˜¯ä¸€å¥—å¾ˆå¥½ç”¨çš„krakenå·¥å…·åŒ…ï¼Œå…¶ä¸­å¸¸ç”¨çš„æœ‰ï¼š</p>
<ol>
<li>
<p>extract_kraken_reads.py
æ­¤ç¨‹åºæå–è¯»å–åœ¨ä»»ä½•ç”¨æˆ·æŒ‡å®šçš„åˆ†ç±»idå¤„åˆ†ç±»çš„å†…å®¹ã€‚ç”¨æˆ·å¿…é¡»æŒ‡å®šKrakenè¾“å‡ºæ–‡ä»¶ã€åºåˆ—æ–‡ä»¶å’Œè‡³å°‘ä¸€ä¸ªåˆ†ç±»æ³•IDã€‚ä¸‹é¢æŒ‡å®šäº†å…¶ä»–é€‰é¡¹ã€‚æˆªè‡³2021å¹´4æœˆ19æ—¥ï¼Œæ­¤è„šæœ¬ä¸KrakenUniq/Kraken2UniqæŠ¥å‘Šå…¼å®¹ã€‚</p>
</li>
<li>
<p>combine_kreports.py
è¿™ä¸ªè„šæœ¬å°†å¤šä¸ªKrakenæŠ¥å‘Šåˆå¹¶åˆ°ä¸€ä¸ªåˆå¹¶çš„æŠ¥å‘Šæ–‡ä»¶ä¸­ã€‚</p>
</li>
<li>
<p>kreport2krona.py
è¿™ä¸ªç¨‹åºéœ€è¦ä¸€ä¸ªKrakenæŠ¥å‘Šæ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºä¸€ä¸ªkronaå…¼å®¹çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ¢æˆkronaæ–‡ä»¶å¥½ç”»å›¾ã€‚</p>
</li>
</ol>
<p>è½¬æ¢åçš„kronaä½¿ç”¨ <code>ktImportText MYSAMPLE.krona -o MYSAMPLE.krona.html</code>å¾—åˆ°ç½‘é¡µå¯è§†åŒ–ç»“æœã€‚</p>
<ol start="4">
<li>
<p>kreport2mpa.py
è¿™ä¸ªç¨‹åºéœ€è¦ä¸€ä¸ªKrakenæŠ¥å‘Šæ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºä¸€ä¸ªmpa (MetaPhlAn)é£æ ¼çš„æ–‡æœ¬æ–‡ä»¶ã€‚</p>
</li>
<li>
<p>combine_mpa.py
è¿™ä¸ªç¨‹åºåˆå¹¶æ¥è‡ªkreport2mpa.pyçš„å¤šä¸ªè¾“å‡ºã€‚</p>
</li>
</ol>
<h3 id="ç‰©ç§åŠŸèƒ½humann">ç‰©ç§+åŠŸèƒ½ï¼šHUMAnN</h3>
<p>HUMAnNï¼ˆThe HMP Unified Metabolic Analysis Networkï¼‰æ˜¯ä¸€æ¬¾ç”¨äºåˆ†æäººç±»å¾®ç”Ÿç‰©ç»„çš„åŠŸèƒ½å’Œä»£è°¢èƒ½åŠ›çš„å·¥å…·ã€‚</p>
<p>å®ƒé€šè¿‡å°†å®åŸºå› ç»„åºåˆ—ä¸å‚è€ƒåŸºå› ç»„æ•°æ®åº“æ¯”å¯¹ï¼Œåˆ©ç”¨MetaCycä»£è°¢é€šè·¯æ•°æ®åº“å’ŒUniRefè›‹ç™½è´¨åºåˆ—æ•°æ®åº“ï¼Œåˆ†æå¾®ç”Ÿç‰©ç»„åœ¨åŠŸèƒ½å’Œä»£è°¢é€šè·¯æ°´å¹³ä¸Šçš„ç»„æˆå’Œæ´»æ€§ã€‚HUMAnN2è¿˜æä¾›äº†å¤šæ ·æ€§åˆ†æã€å…³è”åˆ†æå’Œå¯è§†åŒ–å·¥å…·ï¼Œå¯ç”¨äºæ·±å…¥ç ”ç©¶äººç±»å¾®ç”Ÿç‰©ç»„å¯¹å®¿ä¸»å¥åº·çš„å½±å“å’Œæ²»ç–—ç­–ç•¥çš„åˆ¶å®šç­‰æ–¹é¢ã€‚</p>
<p>HUMAnNæ˜¯ç”±ç¾å›½å›½å®¶äººç±»å¾®ç”Ÿç‰©ç»„è®¡åˆ’ï¼ˆHMPï¼‰å¼€å‘çš„ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸º<a class="link" href="https://github.com/biobakery/humann"  target="_blank" rel="noopener"
    >HUMAnN3</a>ï¼Œäº2020å¹´å‘å¸ƒã€‚ä¸HUMAnN2ç›¸æ¯”ï¼ŒHUMAnN3æ”¹è¿›äº†åŸºå› å®¶æ—æ³¨é‡Šçš„æ–¹æ³•ï¼Œæé«˜äº†æ³¨é‡Šç²¾åº¦å’Œé€Ÿåº¦ï¼Œå¹¶æä¾›äº†æ–°çš„åŠŸèƒ½å’Œå·¥å…·ï¼Œå¦‚åŠŸèƒ½éŸ§åº¦åˆ†æã€ä»£è°¢æŒ‡çº¹è¯†åˆ«å’Œå¤šæ ·æ€§åˆ†æç­‰ã€‚</p>
<p>ä½†æ˜¯HUMAnNçš„æ•°æ®åº“åŸºæœ¬éƒ½æ˜¯ä¸äººç›¸å…³çš„å¾®ç”Ÿç‰©ï¼Œæ¯”è¾ƒé€‚åˆåšå„ç§äººä½“å¾®ç”Ÿç‰©ç»„ï¼ˆè‚ é“ï¼Œè‚ºéƒ¨ï¼Œå£è…”ï¼Œçš®è‚¤ç­‰ç­‰ï¼‰ï¼Œå¯¹äºç¯å¢ƒæ ·æœ¬å¯èƒ½unclassifiedæ¯”è¾ƒå¤šã€‚</p>
<p><strong>HUMAnNè¦æ±‚åŒç«¯åºåˆ—åˆå¹¶çš„æ–‡ä»¶ä½œä¸ºè¾“å…¥</strong>ï¼Œforå¾ªç¯æ ¹æ®å®éªŒè®¾è®¡æ ·æœ¬åæ‰¹é‡åŒç«¯åºåˆ—åˆå¹¶ã€‚</p>
<ul>
<li><strong>ç‰©ç§ç»„æˆè°ƒç”¨MetaPhlAn3, bowtie2æ¯”å¯¹è‡³æ ¸é…¸åºåˆ—åº“</strong>ï¼Œè§£å†³æœ‰å“ªäº›å¾®ç”Ÿç‰©å­˜åœ¨çš„é—®é¢˜ï¼›</li>
<li><strong>åŠŸèƒ½ç»„æˆä¸ºhumann3è°ƒç”¨diamondæ¯”å¯¹è‡³è›‹ç™½åº“</strong>ï¼Œè§£å†³è¿™äº›å¾®ç”Ÿç‰©å‚ä¸å“ªäº›åŠŸèƒ½é€šè·¯çš„é—®é¢˜ï¼›</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> data/rm_human
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="sb">`</span>cat ~/work/asthma/samplelist<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$i</span>
</span></span><span class="line"><span class="cl">cat <span class="si">${</span><span class="nv">i</span><span class="si">}</span>_f1.fastq <span class="si">${</span><span class="nv">i</span><span class="si">}</span>_r2.fastq &gt;<span class="si">${</span><span class="nv">i</span><span class="si">}</span>_paired.fastq
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=humann</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --nodes=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --tasks-per-node=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#set the min and max</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="nv">$START</span> -lt <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nv">START</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="nv">$STOP</span> -gt <span class="m">40</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nv">STOP</span><span class="o">=</span><span class="m">40</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p data/paired
</span></span><span class="line"><span class="cl">  cat data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.1.fq data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.2.fq &gt; data/paired/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_paired.fq
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  mkdir -p result/humann
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/humann --input data/paired/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_paired.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --output result/humann/ --threads <span class="m">24</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  ln result/humann/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_paired_humann_temp/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_paired_metaphlan_bugs_list.tsv result/humann/
</span></span><span class="line"><span class="cl">  rm -rf result/humann/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>_paired_humann_temp
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p result/metaphlan2
</span></span><span class="line"><span class="cl"><span class="c1">## åˆå¹¶ã€ä¿®æ­£æ ·æœ¬å</span>
</span></span><span class="line"><span class="cl">merge_metaphlan_tables2.py <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  result/humann/*_metaphlan_bugs_list.tsv <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  sed <span class="s1">&#39;s/_metaphlan_bugs_list//g&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  &gt; result/metaphlan2/taxonomy.tsv
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="contigs-based">contigs-based</h2>
<p>contigs-basedå®åŸºå› ç»„åˆ†ææ˜¯æŒ‡å…ˆå°†æµ‹åºè¯»é•¿ï¼ˆreadsï¼‰ç»„è£…æˆè¾ƒé•¿çš„åºåˆ—ç‰‡æ®µï¼ˆcontigsï¼‰ï¼Œç„¶åå¯¹è¿™äº›contigsè¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æã€‚è¿™ç§æ–¹æ³•å¯ä»¥æä¾›æ›´é•¿çš„åŸºå› ç»„ç‰‡æ®µï¼Œæœ‰åŠ©äºæ›´å‡†ç¡®åœ°è¿›è¡ŒåŸºå› æ³¨é‡Šå’Œå¾®ç”Ÿç‰©ç¾¤è½ç»“æ„åˆ†æã€‚</p>
<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼š
<ul>
<li><strong>æ›´é«˜çš„è§£æåº¦</strong>ï¼šé€šè¿‡ç»„è£…ç”Ÿæˆè¾ƒé•¿çš„åºåˆ—ç‰‡æ®µï¼Œå¯ä»¥æ›´å‡†ç¡®åœ°è¿›è¡ŒåŸºå› å’ŒåŸºå› ç»„æ³¨é‡Šã€‚</li>
<li><strong>ç»“æ„ä¿¡æ¯</strong>ï¼šèƒ½å¤Ÿè·å¾—é•¿è·ç¦»çš„åŸºå› è”ç³»å’ŒåŸºå› ç»„ç»“æ„ä¿¡æ¯ï¼Œæœ‰åŠ©äºæ›´å…¨é¢çš„åŠŸèƒ½å’Œè¿›åŒ–åˆ†æã€‚</li>
</ul>
</li>
<li><strong>å±€é™æ€§</strong>ï¼š
<ul>
<li><strong>è®¡ç®—èµ„æºéœ€æ±‚é«˜</strong>ï¼šç»„è£…è¿‡ç¨‹éœ€è¦è¾ƒé«˜çš„è®¡ç®—èµ„æºå’Œæ—¶é—´ã€‚</li>
<li><strong>å¤æ‚æ€§</strong>ï¼šç»„è£…å’Œbinningæ­¥éª¤å¢åŠ äº†åˆ†æçš„å¤æ‚æ€§ï¼Œéœ€è¦æ›´å¤šçš„æŠ€æœ¯ç»éªŒå’Œå·¥å…·æ”¯æŒã€‚</li>
</ul>
</li>
</ul>
<h3 id="ç»„è£…assembly">ç»„è£…ï¼ˆassemblyï¼‰</h3>
<p>ç»„è£…ï¼ˆassemblyï¼‰æ˜¯æŒ‡å°†æµ‹åºäº§ç”Ÿçš„çŸ­è¯»é•¿ï¼ˆreadsï¼‰æ‹¼æ¥æˆæ›´é•¿çš„è¿ç»­åºåˆ—ï¼ˆcontigsï¼‰çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨åŸºå› ç»„å­¦å’Œå®åŸºå› ç»„å­¦ç ”ç©¶ä¸­è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿå°†ç‰‡æ®µåŒ–çš„ä¿¡æ¯æ•´åˆæˆæ›´å®Œæ•´çš„åŸºå› ç»„åºåˆ—ï¼Œä¾¿äºåç»­çš„åŠŸèƒ½å’Œåˆ†ç±»åˆ†æã€‚</p>
<p>æ³¨æ„assemblyæœ‰å•æ ·æœ¬æ‹¼è£…å’Œæ··æ‹¼ç­‰ç­–ç•¥ï¼Œå¯ä»¥è‡ªè¡Œæ ¹æ®è®¡ç®—èµ„æºå’Œç ”ç©¶ç›®çš„é€‰æ‹©ã€‚</p>
<ul>
<li>å•æ ·æœ¬æ‹¼è£…ï¼ˆSingle-sample Assemblyï¼‰</li>
</ul>
<p><strong>å®šä¹‰</strong>ï¼šå•æ ·æœ¬æ‹¼è£…æ˜¯æŒ‡å¯¹æ¥è‡ªå•ä¸€ç¯å¢ƒæˆ–æ¡ä»¶ä¸‹çš„æ ·æœ¬è¿›è¡Œç»„è£…ã€‚è¿™ç§ç­–ç•¥é€‚ç”¨äºç›¸å¯¹ç®€å•çš„æ ·æœ¬ï¼Œæˆ–è€…å¸Œæœ›å•ç‹¬åˆ†ææ¯ä¸ªæ ·æœ¬çš„åŸºå› ç»„ç»„æˆã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ç‹¬ç«‹åˆ†æ</strong>ï¼šæ¯ä¸ªæ ·æœ¬å•ç‹¬ç»„è£…ï¼Œæœ‰åŠ©äºæ·±å…¥åˆ†ææ ·æœ¬ç‰¹å®šçš„åŸºå› ç»„ç‰¹å¾ã€‚</li>
<li><strong>æ•°æ®ç®€å•</strong>ï¼šé€‚ç”¨äºæ•°æ®å¤æ‚åº¦è¾ƒä½çš„æ ·æœ¬ï¼Œç»„è£…ç»“æœè¾ƒä¸ºæ¸…æ™°ã€‚</li>
</ol>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ol>
<li><strong>èµ„æºéœ€æ±‚é«˜</strong>ï¼šå¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œç‹¬ç«‹ç»„è£…ï¼Œè®¡ç®—èµ„æºå’Œæ—¶é—´éœ€æ±‚è¾ƒé«˜ã€‚</li>
<li><strong>æœ‰é™çš„è¦†ç›–åº¦</strong>ï¼šå¯¹äºä½ä¸°åº¦å¾®ç”Ÿç‰©ï¼Œå•æ ·æœ¬ç»„è£…å¯èƒ½æ— æ³•æä¾›è¶³å¤Ÿçš„è¦†ç›–åº¦å’Œç»„è£…è´¨é‡ã€‚</li>
</ol>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>
<p>ç¯å¢ƒæ ·æœ¬è¾ƒä¸ºç®€å•çš„ç ”ç©¶ã€‚</p>
</li>
<li>
<p>éœ€è¦å¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œç‹¬ç«‹æ¯”è¾ƒå’Œåˆ†æçš„ç ”ç©¶ã€‚</p>
</li>
<li>
<p>æ··æ‹¼ç­–ç•¥ï¼ˆCo-assemblyï¼‰</p>
</li>
</ul>
<p><strong>å®šä¹‰</strong>ï¼šæ··æ‹¼æ˜¯æŒ‡å°†å¤šä¸ªæ ·æœ¬çš„æ•°æ®åˆå¹¶åœ¨ä¸€èµ·è¿›è¡Œç»„è£…ã€‚è¿™ç§ç­–ç•¥é€‚ç”¨äºå¤æ‚çš„å®åŸºå› ç»„æ ·æœ¬ï¼Œé€šè¿‡æ•´åˆå¤šä¸ªæ ·æœ¬çš„æ•°æ®ï¼Œå¯ä»¥æé«˜ç»„è£…çš„è¦†ç›–åº¦å’Œè´¨é‡ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>æé«˜è¦†ç›–åº¦</strong>ï¼šåˆå¹¶å¤šä¸ªæ ·æœ¬çš„æ•°æ®ï¼Œå¢åŠ äº†åºåˆ—çš„è¦†ç›–åº¦ï¼Œæœ‰åŠ©äºæ›´å®Œæ•´çš„ç»„è£…ã€‚</li>
<li><strong>å¤„ç†å¤æ‚æ ·æœ¬</strong>ï¼šé€‚ç”¨äºå¤æ‚çš„ç¯å¢ƒæ ·æœ¬ï¼Œèƒ½å¤Ÿæ•æ‰åˆ°æ›´å¤šçš„ä½ä¸°åº¦å¾®ç”Ÿç‰©å’ŒåŸºå› ç»„ä¿¡æ¯ã€‚</li>
</ol>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å¤æ‚æ€§å¢åŠ </strong>ï¼šæ··æ‹¼çš„æ•°æ®å¤æ‚åº¦é«˜ï¼Œç»„è£…å’Œåç»­åˆ†ææ›´ä¸ºå¤æ‚ã€‚</li>
<li><strong>æ ·æœ¬é—´å·®å¼‚æ¨¡ç³ŠåŒ–</strong>ï¼šæ ·æœ¬é—´çš„ç‹¬ç‰¹ç‰¹å¾å¯èƒ½åœ¨æ··æ‹¼è¿‡ç¨‹ä¸­è¢«æ¨¡ç³ŠåŒ–ï¼Œå½±å“å¯¹ä¸ªä½“æ ·æœ¬çš„å…·ä½“åˆ†æã€‚</li>
</ol>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ç¯å¢ƒæ ·æœ¬å¤æ‚ï¼ŒåŒ…å«å¤šç§å¾®ç”Ÿç‰©ç¾¤è½ã€‚</li>
<li>éœ€è¦æé«˜ä½ä¸°åº¦ç‰©ç§çš„æ£€æµ‹èƒ½åŠ›ã€‚</li>
<li>ç›®æ ‡æ˜¯è·å–æ•´ä½“å¾®ç”Ÿç‰©ç¾¤è½çš„ç»¼åˆä¿¡æ¯ã€‚</li>
</ul>
<h4 id="megahit">megahit</h4>
<p>Megahitæ˜¯ä¸€ä¸ªç”¨äºå¯¹é«˜é€šé‡æµ‹åºæ•°æ®è¿›è¡Œde novoç»„è£…çš„è½¯ä»¶ã€‚
å®ƒä½¿ç”¨äº†ä¸€ç§åŸºäºçŸ­è¯»æ¯”å¯¹å’Œå›¾å½¢æ„å»ºçš„ç®—æ³•æ¥ç»„è£…åŸºå› ç»„ï¼Œå¯ä»¥é«˜æ•ˆåœ°å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®é›†ã€‚
ä»¥ä¸‹æ˜¯Megahitçš„ä¸€äº›ä¼˜ç‚¹å’Œé€‚ç”¨æƒ…å†µï¼š</p>
<ol>
<li>é€Ÿåº¦å¿«ï¼šMegahitçš„ç®—æ³•éå¸¸é«˜æ•ˆï¼Œå¯ä»¥å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Œé€šå¸¸æ¯”å…¶ä»–de novoç»„è£…å·¥å…·æ›´å¿«ã€‚</li>
<li>é«˜è´¨é‡çš„ç»„è£…ï¼šMegahitåœ¨ç»„è£…ç»“æœçš„è¿é€šæ€§å’Œå‡†ç¡®æ€§æ–¹é¢è¡¨ç°ä¼˜å¼‚ï¼Œå°¤å…¶åœ¨å¤„ç†é«˜GCå«é‡åŸºå› ç»„æ—¶æ•ˆæœæ˜¾è‘—ã€‚</li>
<li>é€‚ç”¨äºä¸åŒç±»å‹çš„æµ‹åºæ•°æ®ï¼šMegahitæ”¯æŒå¤šç§ä¸åŒç±»å‹çš„æµ‹åºæ•°æ®ï¼ŒåŒ…æ‹¬ Illumina HiSeq/MiSeqã€IonTorrentå’ŒPacBioç­‰å¹³å°ã€‚</li>
<li>æ˜“äºä½¿ç”¨ï¼šMegahitå…·æœ‰ç®€å•çš„å‘½ä»¤è¡Œè¯­æ³•ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œç»„è£…æ“ä½œï¼Œä¸”å…·æœ‰ä¸­æ–­ç‚¹ï¼Œé¿å…å¤±è´¥åå…¨éƒ¨é‡è·‘ã€‚</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=megahit</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=10G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#single sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/megahit
</span></span><span class="line"><span class="cl">  mkdir -p result/megahit/contigs
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/megahit -t <span class="m">8</span> -1 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.1.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -2 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.2.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -o result/megahit/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span> --out-prefix <span class="si">${</span><span class="nv">sample</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">  sed -i <span class="s2">&#34;/&gt;/s/&gt;/&gt;</span><span class="si">${</span><span class="nv">sample</span><span class="si">}</span><span class="s2">_/&#34;</span> result/megahit/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.contigs.fa
</span></span><span class="line"><span class="cl">  mv result/megahit/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.contigs.fa result/megahit/contigs/
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ··æ‹¼çš„è¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=megahit2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=mem</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=100G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">#multi-sampleæ··æ‹¼</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#éœ€è¦å¤§å†…å­˜ï¼Œå»ºè®®3å€fq.gzå†…å­˜</span>
</span></span><span class="line"><span class="cl">  mkdir -p data/com_read
</span></span><span class="line"><span class="cl">  mkdir -p result/megahit2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="sb">`</span>cat samplelist<span class="sb">`</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="si">${</span><span class="nv">i</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">      cat data/rm_human/<span class="si">${</span><span class="nv">i</span><span class="si">}</span>.1.fq &gt;&gt; data/com_read/R1.fq
</span></span><span class="line"><span class="cl">      cat data/rm_human/<span class="si">${</span><span class="nv">i</span><span class="si">}</span>.2.fq &gt;&gt; data/com_read/R2.fq
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/megahit -t <span class="m">8</span> -1 data/com_read/R1.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -2 data/com_read/R2.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -o result/megahit2/ --out-prefix multi_sample
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="metaspades">metaSPAdes</h4>
<p>SPAdes æ˜¯ä¸€æ¬¾å¤šåŠŸèƒ½å·¥å…·åŒ…ï¼Œä¸“ä¸ºæµ‹åºæ•°æ®çš„ç»„è£…å’Œåˆ†æè€Œè®¾è®¡ã€‚ SPAdes ä¸»è¦æ˜¯ä¸º Illumina æµ‹åºæ•°æ®è€Œå¼€å‘çš„ï¼Œä½†ä¹Ÿå¯ç”¨äº IonTorrentã€‚å¤§å¤šæ•° SPAdes ç®¡é“æ”¯æŒæ··åˆæ¨¡å¼ï¼Œå³å…è®¸ä½¿ç”¨é•¿è¯»å–ï¼ˆPacBio å’Œ Oxford Nanoporeï¼‰ä½œä¸ºè¡¥å……æ•°æ®ã€‚</p>
<p>è€ŒmetaSPAdesæ˜¯ç›®å‰å®åŸºå› ç»„é¢†åŸŸç»„è£…æŒ‡æ ‡è¾ƒå¥½çš„è½¯ä»¶ï¼Œå°¤å…¶åœ¨æ ªæ°´å¹³ç»„è£…ä¼˜åŠ¿æ˜æ˜¾ã€‚ç›¸æ¯”Megahitè¡¨ç°å‡ºæ›´å¥½çš„åŸºå› é•¿åº¦å’Œè¯»é•¿æ¯”è¾ƒç‡ï¼Œä½†æ˜¯æ›´å¥½çš„ç»„è£…è´¨é‡ä¹Ÿä¼´éšç€æ›´é•¿æ—¶é—´å’Œå†…å­˜æ¶ˆè€—ï¼ŒåŒæ—¶ä¹Ÿæœ‰é”™è¯¯ç»„è£…ä¸Šå‡çš„é£é™©ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=asthma_megahit</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/megahit/log/%x_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/megahit/log/%x_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1-33</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=32</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s1">&#39;%Y-%m-%d %T&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="nv">$SLURM_ARRAY_TASK_ID</span> ~/work/asthma/data/namelist <span class="p">|</span> tail -1<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#sample=$(head -n 1 namelist | tail -1)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> handling: <span class="nv">$sample</span>	
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#single sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/metaspades
</span></span><span class="line"><span class="cl">  mkdir -p result/metaspades/contigs
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/metawrap/bin/metaspades.py â€“t <span class="m">8</span> -k 21,33,55,77,99,127 --careful <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -1 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.1.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -2 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.2.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -o result/metaspades/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  sed -i <span class="s2">&#34;/&gt;/s/&gt;/&gt;</span><span class="si">${</span><span class="nv">sample</span><span class="si">}</span><span class="s2">_/&#34;</span> result/metaspades/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>/scaffolds.fasta
</span></span><span class="line"><span class="cl">  mv result/metaspades/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>/scaffolds.fasta result/metaspades/contigs/
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s1">&#39;%Y-%m-%d %T&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç»„è£…è¯„ä¼°quast">ç»„è£…è¯„ä¼°ï¼šQUAST</h3>
<p><strong>QUAST</strong>æ˜¯ä¸€ä¸ªè´¨é‡è¯„ä¼°å·¥å…·ã€‚ QUASTå¯ä»¥ä½¿ç”¨å‚è€ƒåŸºå› ç»„ä»¥åŠä¸ä½¿ç”¨å‚è€ƒåŸºå› ç»„æ¥è¯„ä¼°è£…é…ã€‚ QUASTç”Ÿæˆè¯¦ç»†çš„æŠ¥å‘Šï¼Œè¡¨æ ¼å’Œå›¾è§£ï¼Œä»¥æ˜¾ç¤ºè£…é…çš„ä¸åŒæ–¹é¢ã€‚</p>
<h3 id="åŸºå› é¢„æµ‹prodigal">åŸºå› é¢„æµ‹ï¼šProdigal</h3>
<p>åŸºå› é¢„æµ‹æ˜¯æŒ‡åœ¨åŸºå› ç»„åºåˆ—ï¼ˆå¦‚contigsï¼‰ä¸­è¯†åˆ«å‡ºç¼–ç åŒºåºåˆ—ï¼ˆCDS, Coding DNA Sequencesï¼‰çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å¯¹äºç†è§£åŸºå› ç»„åŠŸèƒ½å’Œæ³¨é‡ŠåŸºå› ç»„ä¸­çš„åŸºå› æ˜¯è‡³å…³é‡è¦çš„ã€‚å¸¸ç”¨çš„è½¯ä»¶æœ‰Prodigalï¼ŒGeneMarkï¼ˆGeneMarkSç”¨äºç»†èŒï¼ŒGeneMark-ESç”¨äºçœŸæ ¸ç”Ÿç‰©ï¼‰ï¼ŒGlimmerç­‰ã€‚</p>
<p>è¿™é‡Œä»¥Prodigalä¸ºä¾‹ï¼š
è¾“å…¥æ–‡ä»¶ï¼šæ‹¼è£…å¥½çš„åºåˆ—æ–‡ä»¶ megahit/final.contigs.fa
è¾“å‡ºæ–‡ä»¶ï¼šprodigalé¢„æµ‹çš„åŸºå› åºåˆ— prodigal/gene.fa</p>
<p>prodigalä¸æ”¯æŒå¤šçº¿ç¨‹è¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªè¡Œåˆ†å‰²åºåˆ—æ–‡ä»¶è°ƒç”¨å¤šä¸ªprodigalç¨‹åºåˆ†åˆ«è·‘å®ç°ä¼ªå¤šçº¿ç¨‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=prodigal</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/prodigal
</span></span><span class="line"><span class="cl">  mkdir -p result/prodigal/gene_fa
</span></span><span class="line"><span class="cl">  mkdir -p result/prodigal/gene_gff
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/prodigal -i result/megahit/contigs/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.contigs.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -d result/prodigal/gene_fa/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.gene.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -o result/prodigal/gene_gff/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.gene.gff <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -p meta -f gff
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  mkdir -p result/prodigal/fullgene_fa
</span></span><span class="line"><span class="cl">  <span class="c1">## æå–å®Œæ•´åŸºå› (å®Œæ•´ç‰‡æ®µè·å¾—çš„åŸºå› å…¨ä¸ºå®Œæ•´ï¼Œå¦‚æˆç¯çš„ç»†èŒåŸºå› ç»„)</span>
</span></span><span class="line"><span class="cl">  grep <span class="s1">&#39;partial=00&#39;</span> result/prodigal/gene_fa/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.gene.fa <span class="p">|</span> cut -f1 -d <span class="s1">&#39; &#39;</span><span class="p">|</span> sed <span class="s1">&#39;s/&gt;//&#39;</span> &gt; result/prodigal/gene_fa/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.fullid
</span></span><span class="line"><span class="cl">  seqkit grep -f result/prodigal/gene_fa/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.fullid result/prodigal/gene_fa/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.gene.fa &gt; result/prodigal/fullgene_fa/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.gene.fa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å»å†—ä½™">å»å†—ä½™</h3>
<p>åŸºå› é›†å»å†—ä½™æ˜¯æŒ‡åœ¨é¢„æµ‹åˆ°çš„åŸºå› é›†ä¸­å»é™¤é‡å¤çš„åŸºå› æˆ–é«˜åº¦ç›¸ä¼¼çš„åŸºå› ï¼Œä»¥è·å¾—ä¸€ä¸ªéå†—ä½™çš„åŸºå› é›†åˆã€‚è¿™ä¸€æ­¥éª¤åœ¨å®åŸºå› ç»„åˆ†æä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®åŸºå› ç»„æ ·æœ¬ä¸­é€šå¸¸åŒ…å«æ¥è‡ªå¤šç§å¾®ç”Ÿç‰©çš„é‡å¤æˆ–ç›¸ä¼¼åºåˆ—ï¼Œå»å†—ä½™å¯ä»¥ç®€åŒ–æ•°æ®é›†å¹¶æé«˜åç»­åˆ†æçš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚å¸¸ç”¨è½¯ä»¶æœ‰CD-HITï¼ŒMMseqs2ï¼ŒUCLUSTï¼ˆé›†æˆåœ¨QIIMEå’ŒUSEARCHä¸­çš„å·¥å…·ï¼‰ç­‰ã€‚</p>
<p>ä¸Šé¢äº§ç”Ÿäº†nä¸ªæ ·æœ¬çš„åŸºå› é¢„æµ‹ç»“æœæ–‡ä»¶ï¼Œgene.faæ–‡ä»¶è¦å…ˆæƒ³åŠæ³•æ•´åˆä¸ºä¸€ä¸ªæ–‡ä»¶å†å»å»å†—ä½™ã€‚</p>
<h4 id="cd-hit">CD-HIT</h4>
<p>ä¹‹å‰å¤§å®¶å¸¸ç”¨çš„æ˜¯CD-HITæ¥å»å†—ä½™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=cluster</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --nodes=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --tasks-per-node=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;start merge&#34;</span>
</span></span><span class="line"><span class="cl">  cat result/prodigal/gene_fa/*.gene.fa &gt; result/prodigal/all.gene.fa
</span></span><span class="line"><span class="cl">  cat result/prodigal/fullgene_fa/*.gene.fa &gt; result/prodigal/all.fullgene.fa
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;done&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/cd-hit-est -i result/prodigal/all.gene.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -o result/NR/nucleotide.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -aS 0.9 -c 0.9 -G <span class="m">0</span> -g <span class="m">0</span> -T <span class="m">0</span> -M <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  mv result/NR/nucleotide_rep_seq.fasta result/NR/nucleotide.fa
</span></span><span class="line"><span class="cl">  rm result/NR/nucleotide_all_seqs.fasta
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/seqkit translate result/NR/nucleotide.fa &gt; result/NR/protein.fa
</span></span><span class="line"><span class="cl">  sed <span class="s1">&#39;s/\*//g&#39;</span> result/NR/protein.fa &gt; result/NR/protein_no_end.fa
</span></span><span class="line"><span class="cl">  rm result/NR/protein.fa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="mmseqs2">Mmseqs2</h4>
<p>æœ€è¿‘å‘ç°äº†Mmseqs2è¿™ä¸ªç¥å™¨ï¼Œè¿™ä¸ªèšç±»è¦æ¯”CD-HITå¿«éå¸¸å¤šï¼Œå…¶ä»–åº”ç”¨å‚è§<a class="link" href="../mmseqs2" >Mmseqs2çš„åŸºç¡€ä½¿ç”¨</a>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=cluster</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --nodes=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --tasks-per-node=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;start merge&#34;</span>
</span></span><span class="line"><span class="cl">  cat result/prodigal/gene_fa/*.gene.fa &gt; result/prodigal/all.gene.fa
</span></span><span class="line"><span class="cl">  cat result/prodigal/fullgene_fa/*.gene.fa &gt; result/prodigal/all.fullgene.fa
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;done&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  mkdir -p result/NR
</span></span><span class="line"><span class="cl">  mmseqs easy-linclust result/prodigal/all.gene.fa result/NR/nucleotide mmseqs_tmp <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --min-seq-id 0.9 -c 0.9 --cov-mode <span class="m">1</span>  --threads <span class="m">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  mv result/NR/nucleotide_rep_seq.fasta result/NR/nucleotide.fa
</span></span><span class="line"><span class="cl">  rm result/NR/nucleotide_all_seqs.fasta
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/bin/seqkit translate result/NR/nucleotide.fa &gt; result/NR/protein.fa
</span></span><span class="line"><span class="cl">  sed <span class="s1">&#39;s/\*//g&#39;</span> result/NR/protein.fa &gt; result/NR/protein_no_end.fa
</span></span><span class="line"><span class="cl">  rm result/NR/protein.fa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fastaä¿¡æ¯ç»Ÿè®¡">fastaä¿¡æ¯ç»Ÿè®¡</h3>
<p>ä½¿ç”¨seqkitç»Ÿè®¡åˆšåˆšå¾—åˆ°çš„ä¸€äº›å…³é”®fastaæ–‡ä»¶çš„åŸºç¡€ä¿¡æ¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">test_file</span><span class="o">=</span><span class="sb">`</span>head -n1 <span class="nv">$samplelist</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f result/megahit/contigs/<span class="si">${</span><span class="nv">test_file</span><span class="si">}</span>.contigs.fa <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">~/miniconda3/envs/waste/bin/seqkit stats result/megahit/contigs/*.contigs.fa &gt;result/megahit/contig_stats
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f result/prodigal/gene_fa/<span class="si">${</span><span class="nv">test_file</span><span class="si">}</span>.gene.fa <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">~/miniconda3/envs/waste/bin/seqkit stats result/prodigal/gene_fa/*.gene.fa &gt;result/prodigal/gene_fa_stats
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f result/prodigal/fullgene_fa/<span class="si">${</span><span class="nv">test_file</span><span class="si">}</span>.gene.fa <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">~/miniconda3/envs/waste/bin/seqkit stats result/prodigal/fullgene_fa/*.gene.fa &gt;result/prodigal/fullgene_fa_stats
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f result/NR/nucleotide.fa <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">~/miniconda3/envs/waste/bin/seqkit stats result/NR/nucleotide.fa &gt;result/NR/nucleotide_stat
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŸºå› å®šé‡salmon">åŸºå› å®šé‡ï¼šsalmon</h3>
<ol>
<li>å»ºç«‹ç´¢å¼•</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=salmon-index</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=10G</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">## å»ºç´¢å¼•, -tåºåˆ—, -i ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># å¤§ç‚¹å†…å­˜</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/salmon
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/share/salmon/bin/salmon index <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -t result/NR/nucleotide.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -p <span class="m">4</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -i result/salmon/index
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>å¯¹æ¯ä¸ªæ ·æœ¬å®šé‡</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=salmon-quant</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SLURM_ARRAY_TASK_ID: &#34;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">NUMLINES</span><span class="o">=</span><span class="m">40</span> <span class="c1">#how many sample in one array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">STOP</span><span class="o">=</span><span class="k">$((</span>SLURM_ARRAY_TASK_ID*NUMLINES<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$((</span><span class="nv">$STOP</span> <span class="o">-</span> <span class="k">$((</span><span class="nv">$NUMLINES</span> <span class="o">-</span> <span class="m">1</span><span class="k">))))</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;START=</span><span class="nv">$START</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;STOP=</span><span class="nv">$STOP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="c1">## è¾“å…¥æ–‡ä»¶ï¼šå»å†—ä½™åçš„åŸºå› å’Œè›‹ç™½åºåˆ—ï¼šNR/nucleotide.fa</span>
</span></span><span class="line"><span class="cl"><span class="c1">## è¾“å‡ºæ–‡ä»¶ï¼šSalmonå®šé‡åçš„ç»“æœï¼šsalmon/gene.count; salmon/gene.TPM</span>
</span></span><span class="line"><span class="cl"><span class="c1">## å®šé‡ï¼Œlæ–‡åº“ç±»å‹è‡ªåŠ¨é€‰æ‹©ï¼Œpçº¿ç¨‹ï¼Œ--metaå®åŸºå› ç»„æ¨¡å¼</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">$START</span><span class="p">;</span> N &lt;<span class="o">=</span> <span class="nv">$STOP</span><span class="p">;</span> N++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sample</span><span class="o">=</span><span class="k">$(</span>head -n <span class="s2">&#34;</span><span class="nv">$N</span><span class="s2">&#34;</span> <span class="nv">$samplelist</span> <span class="p">|</span> tail -n 1<span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="nv">$sample</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/salmon/quant
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/share/salmon/bin/salmon quant <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --validateMappings <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -i result/salmon/index -l A -p <span class="m">4</span> --meta <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -1 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.1.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -2 data/rm_human/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.2.fq <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -o result/salmon/quant/<span class="si">${</span><span class="nv">sample</span><span class="si">}</span>.quant
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>åˆå¹¶å„æ ·æœ¬ç»“æœ</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=salmon-merge</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nv">samplelist</span><span class="o">=</span>/share/home/jianglab/pengchen/work/asthma/samplelist
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  ls result/salmon/quant/*.quant/quant.sf <span class="p">|</span>awk -F<span class="s1">&#39;/&#39;</span> <span class="s1">&#39;{print $(NF-1)}&#39;</span> <span class="p">|</span>sed <span class="s1">&#39;s/.quant//&#39;</span> &gt;tmp_finished
</span></span><span class="line"><span class="cl">  diff_rows -f samplelist -s tmp_finished &gt;tmp_diff
</span></span><span class="line"><span class="cl">  <span class="c1"># è®¡ç®—ç»“æœçš„è¡Œæ•°</span>
</span></span><span class="line"><span class="cl">  <span class="nv">line_count</span><span class="o">=</span><span class="k">$(</span> cat tmp_diff<span class="p">|</span> wc -l<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># æ£€æŸ¥è¡Œæ•°æ˜¯å¦å¤§äº1ï¼Œå¦‚æœæ˜¯åˆ™ç»ˆæ­¢è„šæœ¬</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$line_count</span><span class="s2">&#34;</span> -gt <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s1">&#39;sfæ–‡ä»¶å’Œsamplelistæ•°é‡ä¸ä¸€è‡´&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">##mapping rates</span>
</span></span><span class="line"><span class="cl">  cat result/salmon/quant/*.quant/logs/salmon_quant.log <span class="p">|</span>grep <span class="s1">&#39;Mapping rate = &#39;</span><span class="p">|</span>awk <span class="s1">&#39;{print $NF}&#39;</span>&gt; tmp
</span></span><span class="line"><span class="cl">  paste samplelist tmp &gt; result/salmon/mapping_rates
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">## combine</span>
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/share/salmon/bin/salmon quantmerge <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --quants result/salmon/quant/*.quant <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      -o result/salmon/gene.TPM
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/waste/share/salmon/bin/salmon quantmerge <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --quants result/salmon/quant/*.quant <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --column NumReads -o result/salmon/gene.count
</span></span><span class="line"><span class="cl">  sed -i <span class="s1">&#39;1 s/.quant//g&#39;</span> result/salmon/gene.*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŠŸèƒ½åŸºå› æ³¨é‡Š">åŠŸèƒ½åŸºå› æ³¨é‡Š</h3>
<p>åŠŸèƒ½åŸºå› æ³¨é‡Šæ˜¯å¯¹éå†—ä½™åŸºå› é›†è¿›è¡Œåˆ†ç±»å’ŒåŠŸèƒ½æè¿°çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿ç†è§£è¿™äº›åŸºå› åœ¨ç”Ÿç‰©ä½“å†…å¯èƒ½çš„è§’è‰²å’Œä½œç”¨ã€‚</p>
<p>ä¸Šä¸€æ­¥å·²ç»æœ‰äº†æ‰€æœ‰çš„åŸºå› å’Œæ¯ä¸ªæ ·æœ¬æ‰€æœ‰åŸºå› çš„read countå®šé‡ç»“æœï¼Œ
æˆ‘ä»¬åªéœ€è¦å¯¹ä¸Šä¸€æ­¥çš„åŸºå› åºåˆ—ï¼ˆæˆ–è›‹ç™½è´¨åºåˆ—ï¼‰è¿›è¡Œä¸åŒæ•°æ®åº“çš„æ³¨é‡Šï¼Œ
ç„¶ååˆå¹¶æ³¨é‡Šç»“æœå¾—åˆ°çš„å°±æ˜¯åŠŸèƒ½ä¸°åº¦è¡¨ã€‚</p>
<p>å¾ˆå¤šæ•°æ®åº“è‡ªå¸¦è½¯ä»¶éƒ½æ˜¯ç”¨diamondæ¯”å¯¹ï¼Œå¦‚æœæ²¡æœ‰ä¸“ç”¨è½¯ä»¶çš„æ•°æ®åº“æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±ç”¨diamondæ¯”å¯¹ã€‚</p>
<p>diamondé€‰æ‹©&ndash;outfmt 6çš„è¾“å‡ºç»“æœå’Œblastpæ ¼å¼ä¸€æ ·ã€‚</p>
<h4 id="eggnog-cogkeggcazy">eggNOG (COG/KEGG/CAZy)</h4>
<p><a class="link" href="http://eggnogdb.embl.de/"  target="_blank" rel="noopener"
    >EggNOGæ•°æ®åº“</a>æ”¶é›†äº†COGï¼ˆClusters of Orthologous Groups of proteinsï¼Œç›´ç³»åŒæºè›‹ç™½ç°‡ï¼‰,æ„æˆæ¯ä¸ªCOGçš„è›‹ç™½éƒ½æ˜¯è¢«å‡å®šä¸ºæ¥è‡ªäºä¸€ä¸ªç¥–å…ˆè›‹ç™½ï¼Œå› æ­¤æ˜¯orthologsæˆ–è€…æ˜¯paralogsã€‚é€šè¿‡æŠŠæ‰€æœ‰å®Œæ•´åŸºå› ç»„çš„ç¼–ç è›‹ç™½ä¸€ä¸ªä¸€ä¸ªçš„äº’ç›¸æ¯”è¾ƒç¡®å®šçš„ã€‚åœ¨è€ƒè™‘æ¥è‡ªä¸€ä¸ªç»™å®šåŸºå› ç»„çš„è›‹ç™½æ—¶ï¼Œè¿™ç§æ¯”è¾ƒå°†ç»™å‡ºæ¯ä¸ªå…¶ä»–åŸºå› ç»„çš„ä¸€ä¸ªæœ€ç›¸ä¼¼çš„è›‹ç™½ï¼ˆå› æ­¤éœ€è¦ç”¨å®Œæ•´çš„åŸºå› ç»„æ¥å®šä¹‰COGï¼‰ï¼Œè¿™äº›åŸºå› çš„æ¯ä¸€ä¸ªéƒ½è½®ç•ªåœ°è¢«è€ƒè™‘ã€‚å¦‚æœåœ¨è¿™äº›è›‹ç™½ï¼ˆæˆ–å­é›†ï¼‰ä¹‹é—´ä¸€ä¸ªç›¸äº’çš„æœ€ä½³åŒ¹é…å…³ç³»è¢«å‘ç°ï¼Œé‚£ä¹ˆé‚£äº›ç›¸äº’çš„æœ€ä½³åŒ¹é…å°†å½¢æˆä¸€ä¸ªCOGã€‚è¿™æ ·ï¼Œä¸€ä¸ªCOGä¸­çš„æˆå‘˜å°†ä¸è¿™ä¸ªCOGä¸­çš„å…¶ä»–æˆå‘˜æ¯”èµ·è¢«æ¯”è¾ƒçš„åŸºå› ç»„ä¸­çš„å…¶ä»–è›‹ç™½æ›´ç›¸åƒã€‚</p>
<p><a class="link" href="http://eggnogdb.embl.de/"  target="_blank" rel="noopener"
    >EggNOG</a>é‡Œé¢å·²ç»åŒ…å«äº†GOï¼ŒKEGGï¼ŒCAZyç­‰ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## ä¸‹è½½å¸¸ç”¨æ•°æ®åº“ï¼Œæ³¨æ„è®¾ç½®ä¸‹è½½ä½ç½®</span>
</span></span><span class="line"><span class="cl">mkdir -p <span class="si">${</span><span class="nv">db</span><span class="si">}</span>/eggnog5 <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="si">${</span><span class="nv">db</span><span class="si">}</span>/eggnog5
</span></span><span class="line"><span class="cl"><span class="c1">## -yé»˜è®¤åŒæ„ï¼Œ-få¼ºåˆ¶ä¸‹è½½ï¼Œeggnog.db.gz 7.9G+4.9G</span>
</span></span><span class="line"><span class="cl">download_eggnog_data.py -y -f --data_dir ./
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## ä¸‹è½½æ–¹å¼2(å¯é€‰)ï¼šé“¾æ¥ç›´æ¥ä¸‹è½½</span>
</span></span><span class="line"><span class="cl">wget -c http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog.db.gz <span class="c1">## 7.9G</span>
</span></span><span class="line"><span class="cl">wget -c http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog_proteins.dmnd.gz <span class="c1">## 4.9G</span>
</span></span><span class="line"><span class="cl">gunzip *.gz
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=eggnog</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=10G</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">  <span class="c1">## å¤§ç‚¹å†…å­˜, æ•°æ®åº“æœ‰50Gå·¦å³</span>
</span></span><span class="line"><span class="cl">  <span class="nb">source</span> ~/miniconda3/etc/profile.d/conda.sh
</span></span><span class="line"><span class="cl">  conda activate func
</span></span><span class="line"><span class="cl">  <span class="c1">## diamondæ¯”å¯¹åŸºå› è‡³eggNOG 5.0æ•°æ®åº“, 1~9hï¼Œé»˜è®¤diamond 1e-3</span>
</span></span><span class="line"><span class="cl">  mkdir -p result/eggnog
</span></span><span class="line"><span class="cl">  emapper.py --no_annot --no_file_comments --override <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --data_dir ~/db/eggnog5 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -i result/NR/protein_no_end.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --cpu <span class="m">8</span> -m diamond <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -o result/eggnog/protein
</span></span><span class="line"><span class="cl">  <span class="c1">## æ¯”å¯¹ç»“æœåŠŸèƒ½æ³¨é‡Š, 1h</span>
</span></span><span class="line"><span class="cl">  emapper.py <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --annotate_hits_table result/eggnog/protein.emapper.seed_orthologs <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --data_dir ~/db/eggnog5 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --cpu <span class="m">8</span> --no_file_comments --override <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -o result/eggnog/output
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">## æ·»è¡¨å¤´, 1åˆ—ä¸ºIDï¼Œ9åˆ—KOï¼Œ16åˆ—CAZyï¼Œ21åˆ—COGï¼Œ22åˆ—æè¿°</span>
</span></span><span class="line"><span class="cl">  sed <span class="s1">&#39;1 i Name\tortholog\tevalue\tscore\ttaxonomic\tprotein\tGO\tEC\tKO\tPathway\tModule\tReaction\trclass\tBRITE\tTC\tCAZy\tBiGG\ttax_scope\tOG\tbestOG\tCOG\tdescription&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    result/eggnog/output.emapper.annotations <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    &gt; result/eggnog/eggnog_anno_output
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="dbcan2ç¢³æ°´åŒ–åˆç‰©">dbCAN2ï¼ˆç¢³æ°´åŒ–åˆç‰©ï¼‰</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## dbCAN2 http://bcb.unl.edu/dbCAN2</span>
</span></span><span class="line"><span class="cl"><span class="c1">## åˆ›å»ºæ•°æ®åº“å­˜æ”¾ç›®å½•å¹¶è¿›å…¥</span>
</span></span><span class="line"><span class="cl">mkdir -p <span class="si">${</span><span class="nv">db</span><span class="si">}</span>/dbCAN2 <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="si">${</span><span class="nv">db</span><span class="si">}</span>/dbCAN2
</span></span><span class="line"><span class="cl"><span class="c1">## ä¸‹è½½åºåˆ—å’Œæè¿°</span>
</span></span><span class="line"><span class="cl">wget -c http://bcb.unl.edu/dbCAN2/download/CAZyDB.07312020.fa
</span></span><span class="line"><span class="cl">wget -c http://bcb.unl.edu/dbCAN2/download/Databases/CAZyDB.07302020.fam-activities.txt
</span></span><span class="line"><span class="cl"><span class="c1">## å¤‡ç”¨æ•°æ®åº“ä¸‹è½½åœ°å€å¹¶è§£å‹ </span>
</span></span><span class="line"><span class="cl"><span class="c1">#wget -c http://210.75.224.110/db/dbcan2/CAZyDB.07312020.fa.gz</span>
</span></span><span class="line"><span class="cl"><span class="c1">#gunzip CAZyDB.07312020.fa.gz</span>
</span></span><span class="line"><span class="cl"><span class="c1">## diamondå»ºç´¢å¼•</span>
</span></span><span class="line"><span class="cl"><span class="nb">time</span> diamond makedb <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --in CAZyDB.07312020.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --db CAZyDB.07312020
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=cazy</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  mkdir -p result/dbcan2
</span></span><span class="line"><span class="cl">  diamond blastp   <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--db ~/db/dbcan2/CAZyDB.07312020  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--query result/NR/protein_no_end.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--threads <span class="m">8</span> -e 1e-5 --outfmt <span class="m">6</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--max-target-seqs <span class="m">1</span> --quiet <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--out result/dbcan2/gene_diamond.f6
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="cardæŠ—ç”Ÿç´ æŠ—æ€§åŸºå› args">CARDï¼ˆæŠ—ç”Ÿç´ æŠ—æ€§åŸºå› ARGsï¼‰</h4>
<p>RGIè½¯ä»¶Githubä¸»é¡µ: <a class="link" href="https://github.com/arpcard/rgi"  target="_blank" rel="noopener"
    >https://github.com/arpcard/rgi</a>ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰å†™çš„<a class="link" href="../antibiotics-resistance" >Antibiotics resistance gene</a>ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=rgi</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">source</span> ~/miniconda3/etc/profile.d/conda.sh
</span></span><span class="line"><span class="cl">  conda activate rgi
</span></span><span class="line"><span class="cl">  mkdir -p result/card
</span></span><span class="line"><span class="cl">  ~/miniconda3/envs/rgi/bin/rgi main <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --input_sequence result/NR/protein_no_end.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --output_file result/card/protein <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --input_type protein --num_threads <span class="m">8</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --clean --alignment_tool DIAMOND <span class="c1"># --low_quality #partial genes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="vfdbæ¯’åŠ›å› å­">VFDBï¼ˆæ¯’åŠ›å› å­ï¼‰</h4>
<p>å®˜ç½‘åœ°å€ï¼š<a class="link" href="http://www.mgc.ac.cn/VFs/"  target="_blank" rel="noopener"
    >http://www.mgc.ac.cn/VFs/</a></p>
<p>åœ¨å®˜ç½‘ä¸‹è½½æ•°æ®åº“æ—¶ï¼Œå¸¦æœ‰setA çš„åº“ä¸ºVFDBæ•°æ®åº“æ ¸å¿ƒåº“(set A)ï¼Œè€ŒsetBä¸ºå…¨åº“(setB), å…¶ä¸­setAä»…åŒ…å«ç»å®éªŒéªŒè¯è¿‡çš„æ¯’åŠ›åŸºå› ï¼Œè€ŒsetBåˆ™åœ¨setAçš„åŸºç¡€ä¸Šå¢åŠ äº†é¢„æµ‹çš„æ¯’åŠ›åŸºå› ï¼Œé€‰æ‹©å¥½æ•°æ®åº“åï¼Œç›´æ¥ç”¨blast/diamondå³å¯å®Œæˆæ³¨é‡Šã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#SBATCH --job-name=vfdb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --output=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.out</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --error=/share/home/jianglab/pengchen/work/asthma/log/%x_%A_%a.err</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --array=1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --partition=cpu</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --cpus-per-task=8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#SBATCH --mem-per-cpu=2G</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> start: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">start</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  mkdir -p result/vfdb
</span></span><span class="line"><span class="cl">  diamond blastp   <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--db ~/db/VFDB/VFDB_setB_pro <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--query result/NR/protein_no_end.fa <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--threads <span class="m">8</span> -e 1e-5 --outfmt <span class="m">6</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--max-target-seqs <span class="m">1</span> --quiet <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  	--out result/vfdb/gene_diamond.f6
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##############</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> end: <span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%d %T&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nv">end</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> TIME:<span class="sb">`</span>expr <span class="nv">$end</span> - <span class="nv">$start</span><span class="sb">`</span>s
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å…¶ä»–æ•°æ®åº“">å…¶ä»–æ•°æ®åº“</h4>
<ul>
<li>NCBI NRï¼ˆNon-redundantï¼‰:åŒ…å«å¹¿æ³›çš„å·²çŸ¥è›‹ç™½åºåˆ—ï¼Œæ˜¯å¸¸ç”¨çš„å‚è€ƒæ•°æ®åº“ã€‚</li>
<li>Pfamï¼šåŒ…å«è›‹ç™½è´¨å®¶æ—å’ŒåŠŸèƒ½åŸŸçš„ä¿¡æ¯ï¼Œé€šè¿‡Hidden Markov Models (HMMs) æè¿°è›‹ç™½è´¨åŠŸèƒ½åŸŸã€‚</li>
<li>å…ƒç´ å¾ªç¯æ•°æ®åº“ï¼šä¸“æ³¨äºç¯å¢ƒä¸­çš„å…ƒç´ ï¼ˆå¦‚ç¢³ã€æ°®ã€ç¡«ã€ç£·ç­‰ï¼‰çš„ç”Ÿç‰©åœ°çƒåŒ–å­¦å¾ªç¯ç›¸å…³åŸºå› å’Œé€”å¾„æ³¨é‡Šã€‚å¦‚NCycDBï¼ŒSCycDBï¼ŒPCycDBï¼ŒMCycDBç­‰</li>
</ul>
<p>è¿™äº›æ•°æ®åº“æˆ‘ä»¬å¯ä»¥è‡ªè¡Œä¸‹è½½è›‹ç™½æ•°æ®åº“ï¼Œç„¶åç”¨blastå»ºåº“æ¯”å¯¹ã€‚</p>
<h3 id="åŠŸèƒ½æ³¨é‡Šåˆå¹¶">åŠŸèƒ½æ³¨é‡Šåˆå¹¶</h3>
<p>å†™ä¸€ä¸ªpythonè„šæœ¬ï¼Œå°†è¡¨1ï¼ˆåŸºå› -åŠŸèƒ½çš„å¯¹åº”è¡¨ï¼‰ä¸è¡¨2ï¼ˆåŸºå› ä¸°åº¦è¡¨ï¼‰åˆå¹¶ï¼Œå³ä¸åŒåŸºå› å¯èƒ½æ³¨é‡Šåˆ°ç›¸åŒåŠŸèƒ½ï¼ŒæŠŠå®ƒä»¬çš„ä¸°åº¦åŠ åœ¨ä¸€èµ·å¾—åˆ°æ–°è¡¨3ï¼ˆåŠŸèƒ½ä¸°åº¦è¡¨ï¼‰ã€‚</p>
<p>å¯ä»¥å‚è€ƒ<a class="link" href="https://github.com/YongxinLiu/EasyMicrobiome/blob/master/script/summarizeAbundance.py"  target="_blank" rel="noopener"
    >https://github.com/YongxinLiu/EasyMicrobiome/blob/master/script/summarizeAbundance.py</a>ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p result/summ_table
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f result/eggnog/eggnog_anno_output <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ±‡æ€»ï¼Œ9åˆ—KOï¼Œ16åˆ—CAZyæŒ‰é€—å·åˆ†éš”ï¼Œ21åˆ—COGæŒ‰å­—æ¯åˆ†éš”ï¼ŒåŸå§‹å€¼ç´¯åŠ </span>
</span></span><span class="line"><span class="cl">~/db/script/summarizeAbundance.py <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -i result/salmon/gene.count <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -m result/eggnog/eggnog_anno_output <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -c <span class="s1">&#39;9,16,21&#39;</span> -s <span class="s1">&#39;,+,+*&#39;</span> -n raw <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -o result/summ_table/eggnog
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/^ko://&#39;</span> summ_table/eggnog.KO.raw.txt
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åˆ†ç®±binning">åˆ†ç®±ï¼ˆbinningï¼‰</h2>
<p>å®åŸºå› ç»„binningæ˜¯æŒ‡å°†ä¸åŒçš„åºåˆ—é›†åˆï¼ˆå¦‚metagenomeåºåˆ—é›†åˆï¼‰æ ¹æ®å®ƒä»¬çš„ç‰©ç§å½’ç±»åˆ°ä¸åŒçš„binsä¸­ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥ç ”ç©¶å®ƒä»¬çš„ç»„æˆå’ŒåŠŸèƒ½ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å°†ç±»ä¼¼çš„åºåˆ—ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä»£è¡¨ä¸åŒç‰©ç§æˆ–åŸºå› ç»„çš„binsï¼Œä»¥ä¾¿è¿›è¡Œåç»­åˆ†æï¼Œå¦‚ç‰©ç§æ³¨é‡Šã€åŸºå› ç»„ç»„è£…ç­‰ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„å®åŸºå› ç»„binningæ–¹æ³•ï¼š</p>
<ol>
<li>
<p>åŸºäºèšç±»çš„æ–¹æ³•ï¼šè¯¥æ–¹æ³•ä½¿ç”¨åºåˆ—èšç±»å°†ç›¸ä¼¼åºåˆ—åˆ†åˆ°åŒä¸€ä¸ªbinä¸­ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œèšç±»ç®—æ³•å¯åˆ†ä¸ºä¸¤ç±»ï¼šæ— ç›‘ç£èšç±»ï¼ˆå¦‚k-meansã€DBSCANç­‰ï¼‰å’Œæœ‰ç›‘ç£èšç±»ï¼ˆå¦‚CAMIã€MyCCç­‰ï¼‰ã€‚</p>
</li>
<li>
<p>åŸºäºç»„è£…çš„æ–¹æ³•ï¼šè¯¥æ–¹æ³•ä½¿ç”¨de novoç»„è£…æ¥å°†ç›¸ä¼¼åºåˆ—ç»„è£…æˆè¿ç»­çš„åºåˆ—ï¼Œå†æ ¹æ®è¿™äº›åºåˆ—çš„åŸºå› ç»„ä¿¡æ¯æ¥å°†å…¶åˆ†ç±»åˆ°ä¸åŒçš„binsä¸­ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æ›´å¥½åœ°å¤„ç†é‡å¤åºåˆ—ï¼Œç¼ºç‚¹æ˜¯éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œæ—¶é—´ã€‚</p>
</li>
<li>
<p>åŸºäºåˆ†ç±»å™¨çš„æ–¹æ³•ï¼šè¯¥æ–¹æ³•ä½¿ç”¨æœºå™¨å­¦ä¹ åˆ†ç±»å™¨æ¥å°†åºåˆ—åˆ†é…åˆ°ä¸åŒçš„binsä¸­ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è‡ªåŠ¨å­¦ä¹ ç‰¹å¾å¹¶åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æ—¶æ•ˆç‡é«˜ï¼Œç¼ºç‚¹æ˜¯éœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªåˆ†ç±»å™¨å¹¶è¿›è¡Œè®­ç»ƒã€‚</p>
</li>
</ol>
<p>åœ¨è¿›è¡Œå®åŸºå› ç»„binningæ—¶ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼Œä»¥é€‰æ‹©æœ€é€‚åˆæ•°æ®é›†çš„æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨ä¸€äº›æµè¡Œçš„å·¥å…·æ¥è¿›è¡Œbinningï¼Œå¦‚MetaBATã€MaxBinã€CONCOCTå’ŒMEGANç­‰ã€‚è¿™äº›å·¥å…·é€šå¸¸åŒ…å«å„ç§binningæ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®æ•°æ®é›†å’Œåˆ†æç›®çš„é€‰æ‹©é€‚åˆçš„æ–¹æ³•ã€‚</p>
<p>ç¯‡å¹…é™åˆ¶ï¼Œå…·ä½“çš„æ–¹æ³•æ”¾åœ¨å¦ä¸€ç¯‡é‡Œé¢è®²è§£å§ï¼ŒæŸ¥çœ‹<a class="link" href="../binning" >å®åŸºå› ç»„åˆ†ç®±æµç¨‹</a>ã€‚</p>
<h2 id="reference">Reference</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-liuPracticalGuideAmplicon2021" class="csl-entry">
<p><span class="csl-left-margin">1. </span><span class="csl-right-inline">Y.-X. Liu, Y. Qin, T. Chen, M. Lu, <em>et al.</em>, <a class="link" href="https://doi.org/10.1007/s13238-020-00724-8"  target="_blank" rel="noopener"
    >A practical guide to amplicon and metagenomic analysis of microbiome data</a>. <em>Protein &amp; Cell</em>. <strong>12</strong>, 315â€“330 (2021).</span></p>
</div>
</div>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/Cao-blog/tags/microbiome/">Microbiome</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/Cao-blog/p/25-nature-4/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/25-nature-4/images/1-2.7f04df50146143db7f38e3c60bbebaa9_hu_4ebeb6bc608a4e31.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ4ï¼‰"
                        data-key="25-nature-4" 
                        data-hash="md5-fwTfUBRhQ9t/OOPGC766qQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ4ï¼‰</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/25-nature-3/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/25-nature-3/images/fig1.20d52f738dfd506b0754bda8d4b0ead0_hu_d6f6d5c8a568f26d.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ3ï¼‰"
                        data-key="25-nature-3" 
                        data-hash="md5-INUvc439UGsHVL2o1LDq0A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ3ï¼‰</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/25-nature-2/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/25-nature-2/images/2-1-2.f13dbba185acaee28c931cc543f77916_hu_94453c680a4ffc60.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ2ï¼‰"
                        data-key="25-nature-2" 
                        data-hash="md5-8T27oYWsruKMkxzFQ/d5Fg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ2ï¼‰</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/25-nature/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/25-nature/images/1-1-1.7ec2e930cb5bff1118bfef6c33cf66bd_hu_e11798ac155eaa9a.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ1ï¼‰"
                        data-key="25-nature" 
                        data-hash="md5-fsLpMMtb/xEYv&#43;9sM89mvQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">25å¹´æœ€æ–°çš„ä¸€äº›Natureç¯å¢ƒå¾®ç”Ÿç‰©ç ”ç©¶æ–‡ç« ï¼ˆ1ï¼‰</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Cao-blog/p/indoor/">
        
        
            <div class="article-image">
                <img src="/Cao-blog/p/indoor/images/ind3.f88b22cb27b61a7f362968c78b715b40_hu_3690543364814c81.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post å®¤å†…å¾®ç”Ÿç‰©ç»„ç›¸å…³ç ”ç©¶"
                        data-key="indoor" 
                        data-hash="md5-&#43;Isiyye2Gn82KWjHi3FbQA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">å®¤å†…å¾®ç”Ÿç‰©ç»„ç›¸å…³ç ”ç©¶</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="Asa12138/pc_blog2"
        issue-term="pathname"
        
        label="none"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025-6 - 
        
        2025 Cao&#39;s blog
    </section>
    
    <section class="powerby">
        
            Email: 17837411716@163.cn <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/Cao-blog/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
